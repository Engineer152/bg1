var Li=Object.defineProperty;var Ri=e=>{throw TypeError(e)};var $i=(e,t,n)=>t in e?Li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var T=(e,t,n)=>$i(e,typeof t!="symbol"?t+"":t,n);var Ct=(e,t,n)=>t.has(e)?Ri("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var we,N,xn,se,Pt,wn,Xe,dt,Ze,et,kn,ve={},In=[],Oi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ge=Array.isArray;function Z(e,t){for(var n in t)e[n]=t[n];return e}function En(e){var t=e.parentNode;t&&t.removeChild(e)}function be(e,t,n){var r,a,s,c={};for(s in t)s=="key"?r=t[s]:s=="ref"?a=t[s]:c[s]=t[s];if(arguments.length>2&&(c.children=arguments.length>3?we.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)c[s]===void 0&&(c[s]=e.defaultProps[s]);return ye(e,c,r,a,null)}function ye(e,t,n,r,a){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:a??++xn,__i:-1,__u:0};return a==null&&N.vnode!=null&&N.vnode(s),s}function x(e){return e.children}function te(e,t){this.props=e,this.context=t}function ae(e,t){if(t==null)return e.__?ae(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?ae(e):null}function Tn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Tn(e)}}function tt(e){(!e.__d&&(e.__d=!0)&&se.push(e)&&!Le.__r++||Pt!==N.debounceRendering)&&((Pt=N.debounceRendering)||wn)(Le)}function Le(){var e,t,n,r,a,s,c,o;for(se.sort(Xe);e=se.shift();)e.__d&&(t=se.length,r=void 0,s=(a=(n=e).__v).__e,c=[],o=[],n.__P&&((r=Z({},a)).__v=a.__v+1,N.vnode&&N.vnode(r),ut(n.__P,r,a,n.__n,n.__P.namespaceURI,32&a.__u?[s]:null,c,s??ae(a),!!(32&a.__u),o),r.__v=a.__v,r.__.__k[r.__i]=r,Cn(c,r,o),r.__e!=s&&Tn(r)),se.length>t&&se.sort(Xe));Le.__r=0}function Nn(e,t,n,r,a,s,c,o,l,d,h){var u,p,f,w,I,v=r&&r.__k||In,k=t.length;for(n.__d=l,Gi(n,t,v),l=n.__d,u=0;u<k;u++)(f=n.__k[u])!=null&&typeof f!="boolean"&&typeof f!="function"&&(p=f.__i===-1?ve:v[f.__i]||ve,f.__i=u,ut(e,f,p,a,s,c,o,l,d,h),w=f.__e,f.ref&&p.ref!=f.ref&&(p.ref&&ht(p.ref,null,f),h.push(f.ref,f.__c||w,f)),I==null&&w!=null&&(I=w),65536&f.__u||p.__k===f.__k?l=Sn(f,l,e):typeof f.type=="function"&&f.__d!==void 0?l=f.__d:w&&(l=w.nextSibling),f.__d=void 0,f.__u&=-196609);n.__d=l,n.__e=I}function Gi(e,t,n){var r,a,s,c,o,l=t.length,d=n.length,h=d,u=0;for(e.__k=[],r=0;r<l;r++)c=r+u,(a=e.__k[r]=(a=t[r])==null||typeof a=="boolean"||typeof a=="function"?null:typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?ye(null,a,null,null,null):Ge(a)?ye(x,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?ye(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a)!=null?(a.__=e,a.__b=e.__b+1,o=Mi(a,n,c,h),a.__i=o,s=null,o!==-1&&(h--,(s=n[o])&&(s.__u|=131072)),s==null||s.__v===null?(o==-1&&u--,typeof a.type!="function"&&(a.__u|=65536)):o!==c&&(o==c-1?u=o-c:o==c+1?u++:o>c?h>l-c?u+=o-c:u--:o<c&&u++,o!==r+u&&(a.__u|=65536))):(s=n[c])&&s.key==null&&s.__e&&!(131072&s.__u)&&(s.__e==e.__d&&(e.__d=ae(s)),nt(s,s,!1),n[c]=null,h--);if(h)for(r=0;r<d;r++)(s=n[r])!=null&&!(131072&s.__u)&&(s.__e==e.__d&&(e.__d=ae(s)),nt(s,s))}function Sn(e,t,n){var r,a;if(typeof e.type=="function"){for(r=e.__k,a=0;r&&a<r.length;a++)r[a]&&(r[a].__=e,t=Sn(r[a],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=ae(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType===8);return t}function ne(e,t){return t=t||[],e==null||typeof e=="boolean"||(Ge(e)?e.some(function(n){ne(n,t)}):t.push(e)),t}function Mi(e,t,n,r){var a=e.key,s=e.type,c=n-1,o=n+1,l=t[n];if(l===null||l&&a==l.key&&s===l.type&&!(131072&l.__u))return n;if(r>(l!=null&&!(131072&l.__u)?1:0))for(;c>=0||o<t.length;){if(c>=0){if((l=t[c])&&!(131072&l.__u)&&a==l.key&&s===l.type)return c;c--}if(o<t.length){if((l=t[o])&&!(131072&l.__u)&&a==l.key&&s===l.type)return o;o++}}return-1}function Dt(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Oi.test(t)?n:n+"px"}function Ee(e,t,n,r,a){var s;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Dt(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Dt(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")s=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase()in e||t==="onFocusOut"||t==="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r?n.u=r.u:(n.u=dt,e.addEventListener(t,s?et:Ze,s)):e.removeEventListener(t,s?et:Ze,s);else{if(a=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function At(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=dt++;else if(t.t<n.u)return;return n(N.event?N.event(t):t)}}}function ut(e,t,n,r,a,s,c,o,l,d){var h,u,p,f,w,I,v,k,m,y,_,g,b,P,$,j,B=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(l=!!(32&n.__u),s=[o=t.__e=n.__e]),(h=N.__b)&&h(t);e:if(typeof B=="function")try{if(k=t.props,m="prototype"in B&&B.prototype.render,y=(h=B.contextType)&&r[h.__c],_=h?y?y.props.value:h.__:r,n.__c?v=(u=t.__c=n.__c).__=u.__E:(m?t.__c=u=new B(k,_):(t.__c=u=new te(k,_),u.constructor=B,u.render=Ui),y&&y.sub(u),u.props=k,u.state||(u.state={}),u.context=_,u.__n=r,p=u.__d=!0,u.__h=[],u._sb=[]),m&&u.__s==null&&(u.__s=u.state),m&&B.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Z({},u.__s)),Z(u.__s,B.getDerivedStateFromProps(k,u.__s))),f=u.props,w=u.state,u.__v=t,p)m&&B.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),m&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(m&&B.getDerivedStateFromProps==null&&k!==f&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(k,_),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(k,u.__s,_)===!1||t.__v===n.__v)){for(t.__v!==n.__v&&(u.props=k,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(Ie){Ie&&(Ie.__=t)}),g=0;g<u._sb.length;g++)u.__h.push(u._sb[g]);u._sb=[],u.__h.length&&c.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(k,u.__s,_),m&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(f,w,I)})}if(u.context=_,u.props=k,u.__P=e,u.__e=!1,b=N.__r,P=0,m){for(u.state=u.__s,u.__d=!1,b&&b(t),h=u.render(u.props,u.state,u.context),$=0;$<u._sb.length;$++)u.__h.push(u._sb[$]);u._sb=[]}else do u.__d=!1,b&&b(t),h=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++P<25);u.state=u.__s,u.getChildContext!=null&&(r=Z(Z({},r),u.getChildContext())),m&&!p&&u.getSnapshotBeforeUpdate!=null&&(I=u.getSnapshotBeforeUpdate(f,w)),Nn(e,Ge(j=h!=null&&h.type===x&&h.key==null?h.props.children:h)?j:[j],t,n,r,a,s,c,o,l,d),u.base=t.__e,t.__u&=-161,u.__h.length&&c.push(u),v&&(u.__E=u.__=null)}catch(Ie){if(t.__v=null,l||s!=null){for(t.__u|=l?160:32;o&&o.nodeType===8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else t.__e=n.__e,t.__k=n.__k;N.__e(Ie,t,n)}else s==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Bi(n.__e,t,n,r,a,s,c,l,d);(h=N.diffed)&&h(t)}function Cn(e,t,n){t.__d=void 0;for(var r=0;r<n.length;r++)ht(n[r],n[++r],n[++r]);N.__c&&N.__c(t,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(s){s.call(a)})}catch(s){N.__e(s,a.__v)}})}function Bi(e,t,n,r,a,s,c,o,l){var d,h,u,p,f,w,I,v=n.props,k=t.props,m=t.type;if(m==="svg"?a="http://www.w3.org/2000/svg":m==="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),s!=null){for(d=0;d<s.length;d++)if((f=s[d])&&"setAttribute"in f==!!m&&(m?f.localName===m:f.nodeType===3)){e=f,s[d]=null;break}}if(e==null){if(m===null)return document.createTextNode(k);e=document.createElementNS(a,m,k.is&&k),s=null,o=!1}if(m===null)v===k||o&&e.data===k||(e.data=k);else{if(s=s&&we.call(e.childNodes),v=n.props||ve,!o&&s!=null)for(v={},d=0;d<e.attributes.length;d++)v[(f=e.attributes[d]).name]=f.value;for(d in v)if(f=v[d],d!="children"){if(d=="dangerouslySetInnerHTML")u=f;else if(d!=="key"&&!(d in k)){if(d=="value"&&"defaultValue"in k||d=="checked"&&"defaultChecked"in k)continue;Ee(e,d,null,f,a)}}for(d in k)f=k[d],d=="children"?p=f:d=="dangerouslySetInnerHTML"?h=f:d=="value"?w=f:d=="checked"?I=f:d==="key"||o&&typeof f!="function"||v[d]===f||Ee(e,d,f,v[d],a);if(h)o||u&&(h.__html===u.__html||h.__html===e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(u&&(e.innerHTML=""),Nn(e,Ge(p)?p:[p],t,n,r,m==="foreignObject"?"http://www.w3.org/1999/xhtml":a,s,c,s?s[0]:n.__k&&ae(n,0),o,l),s!=null)for(d=s.length;d--;)s[d]!=null&&En(s[d]);o||(d="value",w!==void 0&&(w!==e[d]||m==="progress"&&!w||m==="option"&&w!==v[d])&&Ee(e,d,w,v[d],a),d="checked",I!==void 0&&I!==e[d]&&Ee(e,d,I,v[d],a))}return e}function ht(e,t,n){try{if(typeof e=="function"){var r=typeof e.__u=="function";r&&e.__u(),r&&t==null||(e.__u=e(t))}else e.current=t}catch(a){N.__e(a,n)}}function nt(e,t,n){var r,a;if(N.unmount&&N.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||ht(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){N.__e(s,t)}r.base=r.__P=null}if(r=e.__k)for(a=0;a<r.length;a++)r[a]&&nt(r[a],t,n||typeof e.type!="function");n||e.__e==null||En(e.__e),e.__c=e.__=e.__e=e.__d=void 0}function Ui(e,t,n){return this.constructor(e,n)}function Pn(e,t,n){var r,a,s,c;N.__&&N.__(e,t),a=(r=typeof n=="function")?null:t.__k,s=[],c=[],ut(t,e=(!r&&n||t).__k=be(x,null,[e]),a||ve,ve,t.namespaceURI,!r&&n?[n]:a?null:t.firstChild?we.call(t.childNodes):null,s,!r&&n?n:a?a.__e:t.firstChild,r,c),Cn(s,e,c)}function Fi(e,t,n){var r,a,s,c,o=Z({},e.props);for(s in e.type&&e.type.defaultProps&&(c=e.type.defaultProps),t)s=="key"?r=t[s]:s=="ref"?a=t[s]:o[s]=t[s]===void 0&&c!==void 0?c[s]:t[s];return arguments.length>2&&(o.children=arguments.length>3?we.call(arguments,2):n),ye(e.type,o,r||e.key,a||e.ref,null)}function Q(e,t){var n={__c:t="__cC"+kn++,__:e,Consumer:function(r,a){return r.children(a)},Provider:function(r){var a,s;return this.getChildContext||(a=[],(s={})[t]=this,this.getChildContext=function(){return s},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(c){this.props.value!==c.value&&a.some(function(o){o.__e=!0,tt(o)})},this.sub=function(c){a.push(c);var o=c.componentWillUnmount;c.componentWillUnmount=function(){a&&a.splice(a.indexOf(c),1),o&&o.call(c)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}we=In.slice,N={__e:function(e,t,n,r){for(var a,s,c;t=t.__;)if((a=t.__c)&&!a.__)try{if((s=a.constructor)&&s.getDerivedStateFromError!=null&&(a.setState(s.getDerivedStateFromError(e)),c=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,r||{}),c=a.__d),c)return a.__E=a}catch(o){e=o}throw e}},xn=0,te.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Z({},this.state),typeof e=="function"&&(e=e(Z({},n),this.props)),e&&Z(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),tt(this))},te.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),tt(this))},te.prototype.render=x,se=[],wn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Xe=function(e,t){return e.__v.__b-t.__v.__b},Le.__r=0,dt=0,Ze=At(!1),et=At(!0),kn=0;var oe,D,ze,Lt,xe=0,Dn=[],O=N,Rt=O.__b,$t=O.__r,Ot=O.diffed,Gt=O.__c,Mt=O.unmount,Bt=O.__;function ke(e,t){O.__h&&O.__h(D,e,xe||t),xe=0;var n=D.__H||(D.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function E(e){return xe=1,Hi(An,e)}function Hi(e,t,n){var r=ke(oe++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):An(void 0,t),function(o){var l=r.__N?r.__N[0]:r.__[0],d=r.t(l,o);l!==d&&(r.__N=[d,r.__[1]],r.__c.setState({}))}],r.__c=D,!D.u)){var a=function(o,l,d){if(!r.__c.__H)return!0;var h=r.__c.__H.__.filter(function(p){return!!p.__c});if(h.every(function(p){return!p.__N}))return!s||s.call(this,o,l,d);var u=!1;return h.forEach(function(p){if(p.__N){var f=p.__[0];p.__=p.__N,p.__N=void 0,f!==p.__[0]&&(u=!0)}}),!(!u&&r.__c.props===o)&&(!s||s.call(this,o,l,d))};D.u=!0;var s=D.shouldComponentUpdate,c=D.componentWillUpdate;D.componentWillUpdate=function(o,l,d){if(this.__e){var h=s;s=void 0,a(o,l,d),s=h}c&&c.call(this,o,l,d)},D.shouldComponentUpdate=a}return r.__N||r.__}function S(e,t){var n=ke(oe++,3);!O.__s&&ft(n.__H,t)&&(n.__=e,n.i=t,D.__H.__h.push(n))}function mt(e,t){var n=ke(oe++,4);!O.__s&&ft(n.__H,t)&&(n.__=e,n.i=t,D.__h.push(n))}function ie(e){return xe=5,pt(function(){return{current:e}},[])}function pt(e,t){var n=ke(oe++,7);return ft(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function K(e,t){return xe=8,pt(function(){return e},t)}function J(e){var t=D.context[e.__c],n=ke(oe++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(D)),t.props.value):e.__}function zi(){for(var e;e=Dn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Ae),e.__H.__h.forEach(it),e.__H.__h=[]}catch(t){e.__H.__h=[],O.__e(t,e.__v)}}O.__b=function(e){D=null,Rt&&Rt(e)},O.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Bt&&Bt(e,t)},O.__r=function(e){$t&&$t(e),oe=0;var t=(D=e.__c).__H;t&&(ze===D?(t.__h=[],D.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(t.__h.forEach(Ae),t.__h.forEach(it),t.__h=[],oe=0)),ze=D},O.diffed=function(e){Ot&&Ot(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Dn.push(t)!==1&&Lt===O.requestAnimationFrame||((Lt=O.requestAnimationFrame)||ji)(zi)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),ze=D=null},O.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Ae),n.__h=n.__h.filter(function(r){return!r.__||it(r)})}catch(r){t.some(function(a){a.__h&&(a.__h=[])}),t=[],O.__e(r,n.__v)}}),Gt&&Gt(e,t)},O.unmount=function(e){Mt&&Mt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{Ae(r)}catch(a){t=a}}),n.__H=void 0,t&&O.__e(t,n.__v))};var Ut=typeof requestAnimationFrame=="function";function ji(e){var t,n=function(){clearTimeout(r),Ut&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Ut&&(t=requestAnimationFrame(n))}function Ae(e){var t=D,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),D=t}function it(e){var t=D;e.__c=e.__(),D=t}function ft(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function An(e,t){return typeof t=="function"?t(e):t}function Wi(e,t){for(var n in t)e[n]=t[n];return e}function rt(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function Ft(e,t){this.props=e,this.context=t}function _t(e,t){function n(a){var s=this.props.ref,c=s==a.ref;return!c&&s&&(s.call?s(null):s.current=null),t?!t(this.props,a)||!c:rt(this.props,a)}function r(a){return this.shouldComponentUpdate=n,be(e,a)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(Ft.prototype=new te).isPureReactComponent=!0,Ft.prototype.shouldComponentUpdate=function(e,t){return rt(this.props,e)||rt(this.state,t)};var Ht=N.__b;N.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ht&&Ht(e)};var zt=function(e,t){return e==null?null:ne(ne(e).map(t))},Vi={map:zt,forEach:zt,count:function(e){return e?ne(e).length:0},only:function(e){var t=ne(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ne},Yi=N.__e;N.__e=function(e,t,n,r){if(e.then){for(var a,s=t;s=s.__;)if((a=s.__c)&&a.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t)}Yi(e,t,n,r)};var jt=N.unmount;function Ln(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),e.__c.__H=null),(e=Wi({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(r){return Ln(r,t,n)})),e}function Rn(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(r){return Rn(r,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function je(){this.__u=0,this.t=null,this.__b=null}function $n(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Te(){this.u=null,this.o=null}N.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),jt&&jt(e)},(je.prototype=new te).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var a=$n(r.__v),s=!1,c=function(){s||(s=!0,n.__R=null,a?a(o):o())};n.__R=c;var o=function(){if(!--r.__u){if(r.state.__a){var l=r.state.__a;r.__v.__k[0]=Rn(l,l.__c.__P,l.__c.__O)}var d;for(r.setState({__a:r.__b=null});d=r.t.pop();)d.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(c,c)},je.prototype.componentWillUnmount=function(){this.t=[]},je.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Ln(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&be(x,null,e.fallback);return a&&(a.__u&=-33),[be(x,null,t.__a?null:e.children),a]};var Wt=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(Te.prototype=new te).__a=function(e){var t=this,n=$n(t.__v),r=t.o.get(e);return r[0]++,function(a){var s=function(){t.props.revealOrder?(r.push(a),Wt(t,e,r)):a()};n?n(s):s()}},Te.prototype.render=function(e){this.u=null,this.o=new Map;var t=ne(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Te.prototype.componentDidUpdate=Te.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){Wt(e,n,t)})};var On=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,qi=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ki=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Qi=/[A-Z0-9]/g,Ji=typeof document<"u",Xi=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};function Zi(e,t,n){return t.__k==null&&(t.textContent=""),Pn(e,t),typeof n=="function"&&n(),e?e.__c:null}te.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(te.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Vt=N.event;function er(){}function tr(){return this.cancelBubble}function nr(){return this.defaultPrevented}N.event=function(e){return Vt&&(e=Vt(e)),e.persist=er,e.isPropagationStopped=tr,e.isDefaultPrevented=nr,e.nativeEvent=e};var ir={enumerable:!1,configurable:!0,get:function(){return this.class}},Yt=N.vnode;N.vnode=function(e){typeof e.type=="string"&&function(t){var n=t.props,r=t.type,a={};for(var s in n){var c=n[s];if(!(s==="value"&&"defaultValue"in n&&c==null||Ji&&s==="children"&&r==="noscript"||s==="class"||s==="className")){var o=s.toLowerCase();s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&c===!0?c="":o==="translate"&&c==="no"?c=!1:o==="ondoubleclick"?s="ondblclick":o!=="onchange"||r!=="input"&&r!=="textarea"||Xi(n.type)?o==="onfocus"?s="onfocusin":o==="onblur"?s="onfocusout":Ki.test(s)?s=o:r.indexOf("-")===-1&&qi.test(s)?s=s.replace(Qi,"-$&").toLowerCase():c===null&&(c=void 0):o=s="oninput",o==="oninput"&&a[s=o]&&(s="oninputCapture"),a[s]=c}}r=="select"&&a.multiple&&Array.isArray(a.value)&&(a.value=ne(n.children).forEach(function(l){l.props.selected=a.value.indexOf(l.props.value)!=-1})),r=="select"&&a.defaultValue!=null&&(a.value=ne(n.children).forEach(function(l){l.props.selected=a.multiple?a.defaultValue.indexOf(l.props.value)!=-1:a.defaultValue==l.props.value})),n.class&&!n.className?(a.class=n.class,Object.defineProperty(a,"className",ir)):(n.className&&!n.class||n.class&&n.className)&&(a.class=a.className=n.className),t.props=a}(e),e.$$typeof=On,Yt&&Yt(e)};var qt=N.__r;N.__r=function(e){qt&&qt(e),e.__c};var Kt=N.diffed;N.diffed=function(e){Kt&&Kt(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};function Gn(e){return!!e&&e.$$typeof===On}function rr(e){return Gn(e)?Fi.apply(null,arguments):e}function sr(e){return!!e.__k&&(Pn(null,e),!0)}var ar=0;function i(e,t,n,r,a,s){t||(t={});var c,o,l=t;if("ref"in l)for(o in l={},t)o=="ref"?c=t[o]:l[o]=t[o];var d={type:e,props:l,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--ar,__i:-1,__u:0,__source:a,__self:s};if(typeof e=="function"&&(c=e.defaultProps))for(o in c)l[o]===void 0&&(l[o]=c[o]);return N.vnode&&N.vnode(d),d}function or(e){return{render:function(t){Zi(t,e)},unmount:function(){sr(e)}}}let Mn="America/New_York";function cr(e){Mn=e}function L(e){e=new Date(e||Date.now());const t={},n="2-digit";return Intl.DateTimeFormat("en-US",{timeZone:Mn,hourCycle:"h23",year:"numeric",month:n,day:n,hour:n,minute:n,second:n}).formatToParts(e).forEach(r=>t[r.type]=r.value),{date:`${t.year}-${t.month}-${t.day}`,time:`${t.hour}:${t.minute}:${t.second}`}}function U(e){if(e??(e=L()),(e.time??"1")>"03:00:00")return e.date??L().date;const t=new Date(`${e.date}T00:00:00`);return t.setDate(t.getDate()-1),L(t).date}function lr(e,t){const n=new Date(e+"T00:00:00"),r=n.toLocaleString("en-US",{month:"long",day:"numeric"});if(t==="short")return r;const a=U();if(e===a)return`Today, ${r}`;const s=new Date(a);s.setDate(s.getDate()+1);const c=s.toISOString().split("T")[0];return e===c?`Tomorrow, ${r}`:`${n.toLocaleString("en-US",{weekday:"long"})}, ${r}`}function H(e){const t=e.split(":").slice(0,2).map(Number),n=t[0]>=12?"PM":"AM";return t[0]=t[0]%12||12,t.map(r=>String(r).padStart(2,"0")).join(":").replace(/^0/,"")+" "+n}function X(e){const[t,n]=e.slice(0,19).split("T");return{date:t,time:n}}function Re(e){const[t,n]=e.split(":").map(Number);return(t+17)%24*60+n}function he(e){if(!Array.isArray(e))return[];const t=L().time.slice(0,5),n=e.findIndex(r=>r>=t);return n>=0?e.slice(n):[]}const We=e=>Array.isArray(e)?e.join("."):e,G={get(e){const t=localStorage.getItem(We(e));try{return JSON.parse(t??"")}catch{return}},set(e,t){localStorage.setItem(We(e),JSON.stringify(t))},delete(e){localStorage.removeItem(We(e))},clear(){localStorage.clear()}},Ve=["bg1","auth"];class Bn extends Error{constructor(){super("Auth data missing or expired");T(this,"name","ReauthNeeded")}}class dr{constructor(){T(this,"onUnauthorized",()=>{})}getData(){try{const t=G.get(Ve);if(t){const{swid:n,accessToken:r,expires:a}=t,s=L(a),c=L();if(s.date>c.date||s.date===c.date&&s.time>c.time&&s.time>="17")return{swid:n,accessToken:r}}}catch(t){console.error(t)}throw this.deleteData(),new Bn}setData(t){G.set(Ve,t)}deleteData(){G.delete(Ve),setTimeout(this.onUnauthorized)}}const q=new dr,ur=8e3;async function Un(e,t={}){const{params:n,data:r,timeout:a=ur,...s}=t;t=s,t.referrer||(t.referrer=""),t.credentials||(t.credentials="omit"),t.cache||(t.cache="no-store"),t.headers={...t.headers||{}},n&&Object.keys(n).length>0&&(e+=(e.includes("?")?"&":"?")+Object.entries(n).filter(([,d])=>d!=="").map(d=>d.map(encodeURIComponent).join("=")).join("&")),r&&(t.method||(t.method="POST"),t.headers={...t.headers,"Content-Type":"application/json"},t.body=JSON.stringify(r)),t.method||(t.method="GET");const c=new AbortController;t.signal=c.signal;const o=setTimeout(()=>c.abort(),a);let l;try{l=await fetch(e,t)}catch(d){return console.error(d),{ok:!1,status:0,data:null}}finally{clearTimeout(o)}return{ok:l.ok,status:l.status,data:(l.headers.get("Content-Type")||"").startsWith("application/json")?await l.json():{}}}class Fn extends Error{constructor(){super(...arguments);T(this,"name","InvalidOrigin")}}class ue extends Error{constructor(n,r="Request failed"){super(`${r}: ${JSON.stringify(n)}`);T(this,"name","RequestError");this.response=n}}class Me{constructor(t){T(this,"resort");T(this,"origin");this.resort=t,this.origin=this.constructor.origins[this.resort.id]}static originToResortId(t){var a;const r=(a=Object.entries(this.origins).find(([,s])=>s===t))==null?void 0:a[0];if(r)return r;throw new Fn(t)}async request(t){const{swid:n,accessToken:r}=q.getData(),a=this.origin+t.path,s=await Un(a,{method:t.method,params:t.params,data:t.data,headers:{"Accept-Language":"en-US",Authorization:`BEARER ${r}`,"x-user-id":n}});if(s.status===401&&!t.ignoreUnauth)setTimeout(()=>q.deleteData());else{const{key:c}=t;if(s.ok&&(!c||s.data[c]))return{...s,data:c?s.data[c]:s.data}}throw new ue(s)}}T(Me,"origins",{WDW:"https://disneyworld.disney.go.com",DLR:"https://disneyland.disney.go.com"});const hr="modulepreload",mr=function(e){return"/bg1/"+e},Qt={},$e=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),c=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.all(n.map(o=>{if(o=mr(o),o in Qt)return;Qt[o]=!0;const l=o.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${d}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":hr,l||(h.as="script",h.crossOrigin=""),h.href=o,c&&h.setAttribute("nonce",c),document.head.appendChild(h),l)return new Promise((u,p)=>{h.addEventListener("load",u),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${o}`)))})}))}return a.then(()=>t()).catch(s=>{const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s})},pr={48199:"Mr-Incredible",48200:"Mrs-Incredible",261227:"Nemo",339625:"Russell",339626:"Carl",364907:"Jack-Skellington",431014:"Princess-Tiana",431065:"Darth_Vader",15549505:"Rapunzel",15655408:"Default_SignedIn",15675686:"Crush",15831168:"Wall-E",16453979:"Merida",16726412:"Stormtrooper",16818199:"Violet",16869301:"Jack-Jack",17345357:"R2-D2",17345359:"C-3PO",17532220:"Bruce",17532224:"Green-Alien",17532227:"Kermit",17532228:"Sorcerer-Mickey",17577168:"Elsa",17577169:"Anna",17813977:"Olaf",17888784:"Yoda",18101167:"Captain-Mickey",18368743:"-Nick",18368747:"-Judy",18393706:"-Flash",18403761:"kion",18405224:"-Moana",18405236:"-Elena",19633995:"50th_Mickey",19633996:"50th_Minnie",90003819:"Alice",90003846:"Ariel",90003898:"Belle",90003967:"Buzz",90003976:"Captain-Hook",90004004:"Chesire-Cat",90004017:"Cinderella",90004068:"Daisy",90004076:"Dash",90004104:"Donald",90004228:"Goofy",90004260:"Hamm",90004328:"Princess-Jasmine",90004340:"Jiminy",90004395:"Lady",90004482:"Mickey-Mouse",90004486:"Minnie",90004537:"Mulan",90004605:"Peter-Pan",90004625:"Pluto",90004626:"Pocahontas",90004642:"Princess-Aurora",90004682:"Rex",90004772:"Snow-White",90004778:"Sparky",90004846:"TinkerBell",90004860:"Tramp",90004939:"Zero"},gt="https://cdn1.parksmedia.wdprapps.disney.com/resize/mwImage/1/90/90/75/dam/",fr=gt+"wdpro-assets/avatars/180x180/RetAvatar_180x180_",_r=gt+"wdpro-assets/avatars/180x180/RetAvatar-180x180",gr=gt+"disney-world/50th-anniversary/avatars/RetAvatar_180x180_",yr={"-":_r,5:gr};function Oe(e){const t=pr[e||""];if(t)return(yr[t[0]]||fr)+t+".png"}const vr=(e,t,n)=>{const r=e[t];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((a,s)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})},de=(e,t)=>`/das-vas/api/v${t}/${e}`;function Jt(e){return{id:e.id,name:e.name.replace(/ \(Me\)$/,""),avatarImageUrl:Oe(e.characterId)}}function Xt(e,t){return{primaryGuestId:e.id,guestIds:t.map(n=>n.id).join(",")}}class Hn extends Error{constructor(n){super();T(this,"name","ConflictsError");this.conflicts=n}}class br extends Error{constructor(){super(...arguments);T(this,"name","ExperienceUnavailable")}}var lt;class xr extends Me{constructor(){super(...arguments);T(this,"bookingGuestId");Ct(this,lt)}async experiences(n){const r=encodeURIComponent(n.id),{data:a}=await this.request({path:de(`availability/parks/${r}/experiences`,2),key:"experiences"});return a.filter(s=>s.available&&!!s.nextAvailableStartDateTime).map(s=>{const{time:c}=X(s.nextAvailableStartDateTime);try{return{...s,...this.resort.experience(s.id),time:c}}catch{return{...s,time:c}}}).sort((s,c)=>s.name.localeCompare(c.name))}async parties(){const{swid:n}=q.getData(),{data:{bookingGuestId:r,parties:a}}=await this.request({path:de(`users/${encodeURIComponent(n)}/parties`,1)});return this.bookingGuestId=r,a.map(s=>({primaryGuest:Jt(s.primaryGuest),linkedGuests:s.linkedGuests.map(Jt),selectionLimit:s.selectionLimit}))}async book({park:n,experience:r,primaryGuest:a,guests:s}){var h;const c=await this.eligibility({park:n,experience:r,primaryGuest:a,guests:s}),o=new Set((h=c.find(({type:u})=>u==="ELIGIBLE"))==null?void 0:h.guestIds);if(!s.every(u=>o.has(u.id)))throw new Hn(Object.fromEntries(c.filter(u=>u.type!=="ELIGIBLE").flatMap(u=>u.guestIds.map(p=>[p,u.type]))));const l=new Map(s.map(u=>[u.id,u])),{data:d}=await this.request({path:de("bookings",2),key:"booking",data:{bookingGuestId:this.bookingGuestId,primaryGuestId:a.id,guestIds:s.map(u=>u.id),experienceId:r.id,...await this.availability({experience:r,primaryGuest:a,guests:s})}});return{type:"DAS",subtype:"IN_PARK",id:r.id,name:r.name,park:n,guests:d.entitlements.map(u=>{const p=l.get(u.guestId);return{id:u.guestId,name:(p==null?void 0:p.name)??"",avatarImageUrl:p==null?void 0:p.avatarImageUrl,entitlementId:u.id}}),start:X(d.startDateTime),end:{},bookingId:d.id}}async cancelBooking(n){const a=n.map(s=>s.entitlementId).map(encodeURIComponent).join(",");await this.request({path:de(`entitlements/${a}`,1),method:"DELETE"})}async eligibility({park:n,experience:r,primaryGuest:a,guests:s}){const{data:c}=await this.request({path:de("eligibility",1),params:{experienceId:r.id,parkId:n.id,...Xt(a,s)},key:"eligibility"});return c}async availability({experience:n,primaryGuest:r,guests:a}){const s=encodeURIComponent(n.id),{data:{startDateTime:c,endDateTime:o}}=await this.request({path:de(`availability/experiences/${s}`,3),params:Xt(r,a)});if(!c||!o)throw new br;return{startDateTime:c,endDateTime:o}}}lt=new WeakMap;class wr{constructor(t){T(this,"cachedShowtimes",{});this.resort=t}async shows(t){Object.keys(this.cachedShowtimes).length===0&&(this.cachedShowtimes=(await this.request("showtimes")).data);const n=this.cachedShowtimes[t.id]??{},{time:r}=L();return Object.fromEntries(Object.entries(n).flatMap(([a,s])=>{const c=s.filter(u=>u>=r),o=c[0],l=c.slice(1),d=o!==void 0,h=d?void 0:"NO_MORE_SHOWS";try{return[[a,{type:"ENTERTAINMENT",...this.resort.experience(a),park:t,standby:{available:d,unavailableReason:h,nextShowTime:o},additionalShowTimes:l}]]}catch(u){if(u instanceof re)return[];throw u}}))}async request(t){const n=await Un(`https://bg1.joelface.com/livedata/${this.resort.id.toLowerCase()}/${t}.json`);if(!n.ok)throw new Error("Fetch failed");return n}}const kr=e=>e.sort((t,n)=>+n.primary-+t.primary||+n.preselected-+t.preselected||t.name.localeCompare(n.name)),Ir=e=>`/application/v1/guest/${e}`;class yt extends Me{async getQueues(){var n;const t=await this.post({resource:"getQueues"});if(!Array.isArray((n=t.data)==null?void 0:n.queues))throw new ue(t);return t.data.queues.filter(r=>!!r.categoryContentId).map(({queueId:r,tabContentId:a="",...s})=>{const c={...s,id:r};try{c.park=this.resort.park(a.split(";")[0])}catch(o){if(!(o instanceof re))throw o}return c})}async getQueue(t){const n=(await this.getQueues()).find(r=>r.id===t.id);if(n)return n;throw new Error("Queue not Found")}async getLinkedGuests(t){const{data:n}=await this.post({resource:"getLinkedGuests",data:{queueId:t.id,requestType:"REVIEW"}});return kr(n.guests.map(({guestId:r,firstName:a="",lastName:s="",isPrimaryGuest:c,isPreselected:o,avatarImageUrl:l})=>({id:r,name:`${a} ${s}`.trim(),primary:!!c,preselected:!!o,avatarImageUrl:l})))}async joinQueue(t,n){const r=n.map(c=>c.id),a=await this.post({resource:"joinQueue",data:{queueId:t.id,guestIds:r}}),{data:s}=a;if(s.responseStatus==="OK"){const c=s.positions.find(o=>o.queueId===t.id&&o.guestIds.length>0&&r.some(l=>o.guestIds.includes(l)));if(!c)throw new ue(a);return{boardingGroup:c.boardingGroup,conflicts:{},closed:!1}}else if(s.responseStatus==="INVALID_GUEST"||s.responseStatus==="CLOSED_QUEUE"){const c=s.responseStatus==="CLOSED_QUEUE",o=new Set,l={};for(const u of s.conflicts)for(const p of u.guestIds){const f=n.find(w=>w.id===p);f&&(l[f.id]=u.conflictType,o.add(p))}const d=n.filter(u=>!o.has(u.id));if(c||d.length===0)return{boardingGroup:null,conflicts:l,closed:c};const h=await this.joinQueue(t,d);return h.conflicts={...l,...h.conflicts},h}else throw new ue(a)}async post(t){try{return await this.request({...t,method:"data"in t?"POST":"GET",path:Ir(t.resource)})}catch(n){if(n instanceof ue){const r=n.response,{ok:a,status:s}=r;if(!a&&s<500&&s!==401)return r}throw n}}}T(yt,"origins",{WDW:"https://vqguest-svc-wdw.wdprapps.disney.com",DLR:"https://vqguest-svc.wdprapps.disney.com"});class re extends Error{constructor(n){super(`Invalid ID: ${n}`);T(this,"name","InvalidId")}}class zn{constructor(t,n){T(this,"parks");T(this,"genie");T(this,"vq");T(this,"das");T(this,"liveData");T(this,"parksById");T(this,"expsById");T(this,"dropExpsByPark");var r,a,s;this.id=t,this.parks=n.parks,this.parksById=Object.fromEntries(this.parks.map(c=>[c.id,c])),this.expsById=n.experiences,this.dropExpsByPark=new Map(this.parks.map(c=>[c,[]]));for(const[c,o]of Object.entries(this.expsById))o&&(o.id=c,o.park=o.land.park),o!=null&&o.dropTimes&&((r=this.dropExpsByPark.get(o.land.park))==null||r.push(o));for(const c of this.parks)c.dropTimes=[...new Set((a=this.dropExpsByPark.get(c))==null?void 0:a.flatMap(o=>o.dropTimes??[]))].sort(),(s=this.dropExpsByPark.get(c))==null||s.sort((o,l)=>o.name.localeCompare(l.name));this.genie=t==="WDW"?new Pr(this):new Dr(this),this.vq=new yt(this),this.das=new xr(this),this.liveData=new wr(this)}experience(t){const n=this.expsById[t];if(n)return n;throw n!==null&&console.warn(`Missing experience: ${t}`),new re(t)}park(t){const n=this.parksById[t];if(n)return n;throw new re(t)}dropExperiences(t){return this.dropExpsByPark.get(t)??[]}}async function Er(e){const t=await vr(Object.assign({"./data/dlr.ts":()=>$e(()=>import("./dlr.js"),[]),"./data/wdw.ts":()=>$e(()=>import("./wdw.js"),[])}),`./data/${e.toLowerCase()}.ts`,3);return new zn(e,t)}const Tr={WDW:"wdw-itinerary-api",DLR:"dlr-itinerary-web-api"},Nr={WDW:{id:"80010110",park:{id:"80007944"}},DLR:{id:"353295",park:{id:"330339"}}},Sr=new Set(["ACTIVITY","DINING"]),Ne=e=>e.split(";")[0];function jn(e){const t=L();return e.modifiable&&U(e.start)===U(t)}class Cr extends Error{constructor(){super(...arguments);T(this,"name","ModifyNotAllowed")}}function Wn(e){if(e&&!jn(e))throw new Cr}function Ye(e,t,n){return+(e.ineligibleReason===n)-+(t.ineligibleReason===n)}class vt extends Me{constructor(n,r){super(n);T(this,"allowsCrossParkModify",!1);T(this,"allowsTimeSelect",!1);T(this,"maxPartySize",12);T(this,"nextBookTime");T(this,"onUnauthorized",()=>{});T(this,"partyIds",new Set);T(this,"guestCache",new Map);T(this,"tracker");T(this,"primaryGuestId","");T(this,"convertGuest",n=>{const{id:r,firstName:a,lastName:s,characterId:c,...o}=n,l=`${a} ${s}`.trim();if(!this.guestCache.has(r))switch(n.ineligibleReason){case"INVALID_PARK_ADMISSION":case"PARK_RESERVATION_NEEDED":case"GENIE_PLUS_NEEDED":n.primary&&this.cacheGuest(r,l,c);break;default:this.cacheGuest(r,l,c)}const d=Oe(c);return this.partyIds.size>0&&!this.partyIds.has(r)&&(o.ineligibleReason="NOT_IN_PARTY",delete o.eligibleAfter),{...o,id:r,name:l,avatarImageUrl:d}});this.tracker=r??new Ar}setPartyIds(n){this.partyIds=new Set(n)}async experiences(n){return this.requestExperiences(n,{path:`/tipboard-vas/planning/v1/parks/${encodeURIComponent(n.id)}/experiences/`,params:{eligibilityGuestIds:[...this.guestCache.keys()].join(",")},userId:!0})}async requestExperiences(n,r){var s,c,o,l;await this.primeGuestCache();const{data:a}=await this.request(r);return this.nextBookTime=(l=(((o=(c=(s=a.eligibility)==null?void 0:s.geniePlusEligibility)==null?void 0:c[U()])==null?void 0:o.flexEligibilityWindows)||[]).sort((d,h)=>d.time.time.localeCompare(h.time.time))[0])==null?void 0:l.time.time,a.availableExperiences.flatMap(d=>{try{return[{...d,...this.resort.experience(d.id),park:n,experienced:this.tracker.experienced(d)}]}catch(h){if(h instanceof re)return[];throw h}})}async cancelBooking(n){const a=n.map(s=>s.entitlementId).map(encodeURIComponent).join(",");await this.request({path:`/ea-vas/api/v1/entitlements/${a}`,method:"DELETE"})}async bookings(){const{swid:n}=q.getData(),r=L().date,a=U(),s=Tr[this.resort.id],{data:{items:c=[],assets:o={},profiles:l={}}}=await this.request({path:`/plan/${s}/api/v1/itinerary-items/${n}?item-types=FASTPASS&item-types=DINING&item-types=ACTIVITY&item-types=VIRTUAL_QUEUE_POSITION`,params:{destination:this.resort.id,fields:"items,profiles,assets","guest-locators":n+";type=swid","guest-locator-groups":"MY_FAMILY","start-date":r,"show-friends":"false"},ignoreUnauth:!0}),d=m=>{const{name:y,avatarId:_,type:g}=l[m.id];return{id:Ne(m.id),name:`${y.firstName} ${y.lastName}`.trim(),avatarImageUrl:Oe(_),...g==="transactional"&&{transactional:!0}}},h=m=>{const y=o[m.asset],g=o[y.facility].location??"",b=this.getPark(g);b.name===""&&g&&(b.name=o[g].name);const P=new Date(m.startDateTime);return{type:"RES",subtype:m.type,id:Ne(m.asset),park:b,name:y.name,start:L(P),guests:m.guests.map(d).sort((j,B)=>+(B.id===this.primaryGuestId)-+(j.id===this.primaryGuestId)||+!B.transactional-+!j.transactional||j.name.localeCompare(B.name)),bookingId:m.id}},u=m=>{const y=o[m.facility],_=new Set;return{...this.getBookingExperienceData(m.facility,y.location,y.name),start:(m.displayStartDate??r)<a?{date:a}:{date:m.displayStartDate??r,time:m.displayStartTime},end:{date:m.displayEndDate,time:m.displayEndTime},guests:m.guests.filter(g=>_.has(g.id)||g.redemptionsRemaining===0?!1:(_.add(g.id),!0)).map(g=>({...d(g),entitlementId:g.entitlementId,bookingId:g.bookingId,...g.redemptionsRemaining!==void 0&&{redemptions:Math.min(g.redemptionsRemaining,g.redemptionsAllowed??1)}})),bookingId:m.id}},p=m=>{const y={FLEX:"G+",STANDARD:"ILL",OTHER:"OTHER"},_=m.multipleExperiences?"MEP":y[m.kind];if(!_)return;const g=_==="G+";let b={type:"LL",subtype:_,...u(m),cancellable:m.cancellable&&g,modifiable:m.modifiable&&g,bookingId:m.id};if(b.modifiable=jn(b),m.multipleExperiences){const P=m.assets.find($=>$.original);b={...b,...P?this.getBookingExperienceData(P.content,o[P.content].location):{id:"",name:""}},b.choices=m.assets.filter($=>!$.excluded&&!$.original).map(({content:$})=>{const{name:j,location:B}=o[$];return this.getBookingExperienceData($,B,j)}).sort(($,j)=>$.name.localeCompare(j.name))}return b},f=m=>{const _={DAS:"IN_PARK",FDS:"ADVANCE"}[m.kind],g=_==="IN_PARK";return{type:"DAS",subtype:_,cancellable:m.cancellable&&g,...u(m)}},w=m=>{const y=o[m.asset],_=o[y.facility],g=this.getBookingExperienceData(y.facility,_.location,y.name);return g.park.name===""&&(g.park.name=_.name),{...g,type:"BG",boardingGroup:m.boardingGroup.id,status:m.status,start:L(new Date(m.startDateTime)),guests:m.guests.map(d),bookingId:m.id}},v={PARK_PASS:m=>{const y=this.getPark(o[m.facility].location);if(y)return{type:"APR",id:y.id,name:y.name,park:y,start:{date:m.displayStartDate,time:"06:00:00"},guests:m.guests.map(d),bookingId:m.id}},DAS:f,FDS:f},k=c.map(m=>{try{if(m.type==="FASTPASS")return(v[m.kind]??p)(m);if(m.type==="VIRTUAL_QUEUE_POSITION")return w(m);if(m.type&&Sr.has(m.type))return h(m)}catch(y){console.error(y)}}).filter(m=>!!m);return this.tracker.update(k,this),k}getPark(n){n=Ne(n);try{return this.resort.park(n)}catch(r){if(r instanceof re)return{id:n,name:"",icon:"",geo:{n:0,s:0,e:0,w:0},theme:{bg:"bg-blue-500",text:"text-blue-500"},dropTimes:[]};throw r}}getBookingExperienceData(n,r,a="Experience"){n=Ne(n);try{const s=this.resort.experience(n);return{id:n,name:s.name,park:s.park}}catch(s){if(s instanceof re&&r)return{id:n,name:a,park:this.getPark(r)};throw s}}async primeGuestCache(){this.primaryGuestId===""&&(await this.guests(),this.primaryGuestId||(this.primaryGuestId="."))}cacheGuest(n,r,a){this.guestCache.set(n,{name:r,characterId:a})}async request(n){if(n.userId){const{swid:r}=q.getData();n={...n},n.params={...n.params,userId:r}}return super.request(n)}parseGuests(n){var o;const{guests:r,ineligibleGuests:a}=n;this.primaryGuestId=((o=[...r,...a].find(l=>!!l.primary))==null?void 0:o.id)??this.primaryGuestId;const s=r.map(this.convertGuest),c=a.map(this.convertGuest);return c.sort((l,d)=>{const h=+!l.primary-+!d.primary||l.name.localeCompare(d.name);return l.eligibleAfter||d.eligibleAfter?(l.eligibleAfter||"99").localeCompare(d.eligibleAfter||"99")||h:l.ineligibleReason===d.ineligibleReason?h:Ye(l,d,"NOT_IN_PARTY")||Ye(l,d,"MULTI_PASS_NEEDED")||Ye(d,l,"EXPERIENCE_LIMIT_REACHED")||h}),{eligible:s,ineligible:c}}fallbackExperience(n){return n?this.resort.experience(n.id):Nr[this.resort.id]}}class Pr extends vt{constructor(){super(...arguments);T(this,"allowsCrossParkModify",!0);T(this,"allowsTimeSelect",!0)}async experiences(n,r){return this.requestExperiences(n,!r||L().date===r?{path:`/tipboard-vas/planning/v1/parks/${encodeURIComponent(n.id)}/experiences/`,params:{eligibilityGuestIds:[...this.guestCache.keys()].join(",")},userId:!0}:{path:""})}async guests(n){const r=this.fallbackExperience(n),{data:{guests:a,ineligibleGuests:s}}=await this.request({path:"/ea-vas/planning/api/v1/experiences/guest/guests",data:{date:L().date,facilityId:r.id,parkId:r.park.id}});return this.parseGuests({guests:a,ineligibleGuests:s.map(c=>c.ineligibleReason?{...c,ineligibleReason:c.ineligibleReason.ineligibleReason}:c)})}async offer(n,r,a){Wn(a);const{date:s,time:c}=L(),{data:o}=await this.request({path:`/ea-vas/planning/api/v1/experiences${a?"/mod":""}/offerset/generate`,data:{date:a?a.start.date:s,parkId:n.park.id,guestIds:r.map(v=>v.id),targetedTime:n.flex.nextAvailableTime??c,ignoredBookedExperienceIds:null,...a?{experienceId:n.id,originalExperienceId:a==null?void 0:a.id,originalEntitlementIds:a==null?void 0:a.guests.map(v=>v.entitlementId)}:{experienceIds:[n.id]}}}),l=o.itinerary.items.find(v=>v.type==="OFFER_ITEM"),{guests:d,ineligibleGuests:h}=o.party;if(!l)throw new ue({ok:!1,status:410,data:o});const{offerSetId:u,offerId:p,startDateTime:f,endDateTime:w}=l,I=Object.fromEntries(r.map(v=>[v.id,v]));return{offerSetId:u,id:p,start:X(f),end:X(w),experience:n,guests:{eligible:(d||[]).map(v=>({...I[v.id],...this.convertGuest(v)})),ineligible:(h||[]).map(this.convertGuest)},active:!0,changed:l.conflict==="ALTERNATIVE_TIME_FOUND",modifying:a}}async times(n){const{data:r}=await this.request({path:`/ea-vas/planning/api/v1/experiences${n.modifying?"/mod":""}/offerset/times`,data:{experienceId:n.experience.id,parkId:n.experience.park.id,date:n.start.date,offerId:n.id,offerSetIds:[n.offerSetId],guestIds:n.guests.eligible.map(a=>a.id),offerType:"FLEX",experienceIdsToIgnore:[],originalOrderItemId:null}});return r.hourSegmentGroups.map(a=>({hour:Number(a.hourSegmentWindow.startTime.split(":")[0]),slots:a.inventorySlotsAvailability.map(({startTime:s,endTime:c})=>({startTime:s,endTime:c}))}))}async changeOfferTime(n,r){const{data:{updatedPlanningOfferDisplayItem:a}}=await this.request({path:`/ea-vas/planning/api/v1/experiences${n.modifying?"/mod":""}/offerset/times/fulfill`,data:{parkId:n.experience.park.id,date:n.start.date,offerId:n.id,...n.modifying?{offerSetId:n.offerSetId}:{offerSetIds:[n.offerSetId]},offerType:"FLEX",guestIds:n.guests.eligible.map(s=>s.id),targetSlot:r,experienceIdsToIgnore:[]}});return{...n,id:a.offerId,offerSetId:a.offerSetId,start:X(a.startDateTime),end:X(a.endDateTime),changed:a.conflict==="ALTERNATIVE_TIME_FOUND"}}async book(n,r){if(n.modifying)return this.modify(n,r);const{data:a}=await this.request({path:"/ea-vas/planning/api/v1/experiences/entitlements/book",data:{offerSetId:n.offerSetId,orderGuestDetails:n.guests.eligible.filter(s=>!!s.orderDetails).map(({id:s,orderDetails:{externalIdentifier:c,...o}})=>({guestDetails:[{guestId:s,externalIdentifier:c}],...o}))}});return this.createLLFromResponse(a)}async modify(n,r){const{offerSetId:a,guests:{eligible:s}}=n,c=new Set((r??n.guests.eligible).map(d=>d.id)),o=Object.fromEntries(n.modifying.guests.map(d=>[d.id,d.entitlementId])),{data:l}=await this.request({path:"/ea-vas/planning/api/v1/experiences/mod/entitlements/book",data:{offerSetId:a,eligibleGuestsEntitlements:s.filter(d=>c.has(d.id)).map(d=>({guestId:d.id,entitlementId:o[d.id],...d.orderDetails}))}});return this.createLLFromResponse({entitlementExperiences:[l.booking],party:l.party})}createLLFromResponse(n){var s;const r=n.entitlementExperiences[0],a=Object.fromEntries(r.guests.map(c=>[c.guestId,c.entitlementId]));return{type:"LL",subtype:"G+",...this.getBookingExperienceData(r.experienceId),bookingId:(s=r.guests[0])==null?void 0:s.entitlementId,start:X(r.startDateTime),end:X(r.endDateTime),cancellable:!0,modifiable:!1,guests:n.party.guests.map(c=>({...this.convertGuest(c),entitlementId:a[c.id]}))}}}class Dr extends vt{async guests(t){const n=this.fallbackExperience(t),{data:r}=await this.request({path:"/ea-vas/api/v1/guests",params:{productType:"FLEX",experienceId:n.id,parkId:n.park.id},userId:!0});return this.parseGuests(r)}async offer(t,n,r){Wn(r);const{data:{offer:{id:a,date:s,startTime:c,endTime:o,status:l,changeStatus:d},eligibleGuests:h,ineligibleGuests:u}}=await this.request({path:r?"/ea-vas/api/v1/products/modifications/flex/offers":"/ea-vas/api/v2/products/flex/offers",method:"POST",data:{guestIds:((r==null?void 0:r.guests)??n).map(p=>p.id),ineligibleGuests:[],primaryGuestId:n.map(p=>p.id).sort((p,f)=>p.localeCompare(f))[0],parkId:t.park.id,experienceId:t.id,selectedTime:t.flex.nextAvailableTime,...r?{date:L().date,modificationType:t.id===r.id?"TIME":"EXPERIENCE"}:{}}});return $e(()=>import("./diu.js"),[]),{id:a,start:{date:s,time:c},end:{date:s,time:o},active:l==="ACTIVE",changed:d!=="NONE",modifying:r,guests:{eligible:(h||[]).map(this.convertGuest),ineligible:(u||[]).map(this.convertGuest)},experience:t}}async times(){return[]}async changeOfferTime(t){return t}async book(t,n){var u;const r=(await $e(async()=>{const{default:p}=await import("./diu.js");return{default:p}},[])).default,a=new Set((n??t.guests.eligible).map(p=>p.id)),{data:s}=await this.request({path:t.modifying?"/ea-vas/api/v2/products/modifications/flex/bookings":"/ea-vas/api/v2/products/flex/bookings",method:"POST",data:{offerId:t.id,...await r(t.id),...t.modifying?{date:L().date,modificationType:t.modifying.id===t.experience.id?"TIME":"EXPERIENCE",existingEntitlements:t.modifying.guests.filter(p=>a.has(p.id)).map(p=>({entitlementId:p.entitlementId,entitlementBookingId:p.bookingId})),guestIdsToExclude:t.modifying.guests.filter(p=>!a.has(p.id)).map(p=>p.id)}:{}},key:"booking"}),{singleExperienceDetails:{experienceId:c,parkId:o},entitlements:l,startDateTime:d,endDateTime:h}=s;return{type:"LL",subtype:"G+",...this.getBookingExperienceData(c,o),bookingId:(u=l[0])==null?void 0:u.id,start:X(d),end:X(h),cancellable:!0,modifiable:!1,guests:l.map(p=>{const f=this.guestCache.get(p.guestId);return{id:p.guestId,name:(f==null?void 0:f.name)||"",avatarImageUrl:Oe(f==null?void 0:f.characterId),entitlementId:p.id}})}}}const Zt=["bg1","genie","bookings"];class Ar{constructor(){T(this,"date");T(this,"expIds",new Set);T(this,"experiencedExpIds",new Set);const{date:t=U(),expIds:n=[],experiencedExpIds:r=[]}=G.get(Zt)??{};this.date=t,this.expIds=new Set(n),this.experiencedExpIds=new Set(r),this.checkDate()}experienced(t){return this.experiencedExpIds.has(t.id)}async update(t,n){this.checkDate();const r=U(),a=t.filter(c=>c.type==="LL"&&!!c.cancellable&&U(c.start)===r);for(const c of a)this.experiencedExpIds[c.modifiable?"delete":"add"](c.id);const s=this.expIds;this.expIds=new Set(a.map(c=>c.id));for(const c of s){if(this.expIds.has(c))continue;const{ineligible:o}=await n.guests({id:c}),l=o.some(d=>d.ineligibleReason==="EXPERIENCE_LIMIT_REACHED");this.experiencedExpIds[l?"add":"delete"](c)}G.set(Zt,{date:this.date,expIds:[...this.expIds],experiencedExpIds:[...this.experiencedExpIds]})}checkDate(){const t=U();this.date!==t&&(this.date=t,this.expIds=new Set,this.experiencedExpIds=new Set)}}const Vn=Q(new zn("WDW",{experiences:{},parks:[]})),Lr=Vn.Provider,A=()=>J(Vn),Yn=Q({goTo:()=>{},goBack:async()=>{}}),Rr=Yn.Provider,R=()=>J(Yn),qn=Q({current:i("div",{})}),$r=qn.Provider,Kn=()=>J(qn);let Or=0;const en=()=>++Or,Se=()=>Number(location.hash.slice(1))||0;let qe=()=>{};function Qn({children:e}){const[t,n]=E({current:e}),r=ie([{elem:e,key:0}]),a=ie({goTo(c,o){let l=Se(),d;o!=null&&o.replace?(d=r.current[l].key??en(),n(h=>({...h,current:c}))):(r.current=r.current.slice(0,++l),location.hash=`#${l}`,d=en()),r.current[l]={elem:c,key:d}},goBack({screen:c,props:o}={}){if(c){const l=Se();for(let d=l-1;d>=0;--d)if(r.current[d].elem.type===c){if(history.go(d-l),o){const h={...r.current[d].elem.props,...o};r.current[d].elem=i(c,{...h})}break}}else history.back();return new Promise(l=>{qe=()=>{l(),qe=()=>{}}})}});S(()=>{function c(){var d,h;qe();const l=Se();l>=r.current.length?history.back():n({current:((d=r.current[l])==null?void 0:d.elem)??i("div",{}),prev:(h=r.current[l-1])==null?void 0:h.elem})}function o(l){l.preventDefault()}return location.replace("#0"),addEventListener("hashchange",c),addEventListener("beforeunload",o),()=>{removeEventListener("hashchange",c),removeEventListener("beforeunload",o)}},[]);const s=Math.min(Se(),r.current.length-1);return i(Rr,{value:a.current,children:i($r,{value:t,children:r.current.slice(0,s+1).map(({elem:c,key:o},l)=>i("article",{hidden:l!==s,children:c},o))})})}const bt={bg:"bg-blue-500",text:"text-blue-500"},Jn=Q(bt),Xn=Jn.Provider,W=()=>J(Jn),Gr={normal:"py-1",small:"py-1.5 text-xs uppercase tracking-wide",full:"w-full py-3"};function C(e){const{goBack:t}=R(),{type:n,back:r,onClick:a,className:s,...c}=e;let o=`${Gr[n||"normal"]} ${s||""}`;const{bg:l}=W();return o.includes(" bg-")||(o+=` ${l} text-white`),i("button",{onClick:async()=>{a&&await a(),r&&(r===!0?t():t(r))},className:`${o} inline-flex items-center justify-center min-w-[36px] rounded-lg px-2 font-semibold disabled:opacity-50`,...c})}function V(e){return i("div",{className:"mb-20",children:i("div",{className:"fixed bottom-0 left-0 w-full px-5 pb-5 text-center",children:i(C,{...e,className:"max-w-2xl mx-auto shadow-[0px_4px_8px_-1px_#0005]",type:"full"})})})}function z({children:e,className:t,title:n}){return t||(t=""),t.match(/\bw-\S+\s*/)||(t+=" w-4"),t.match(/\bh-\S+\s*/)||(t+=" h-auto"),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",className:`mx-auto ${t}`,role:"img",children:[n&&i("title",{children:n}),e]})}/**
 * Modified arrow-left2 icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Mr(e){return i(z,{...e,children:i("path",{d:"M0.293,7.337L7.333,0.297C7.723,-0.093 8.357,-0.093 8.747,0.297C9.137,0.687 9.137,1.321 8.747,1.711L3.414,7.044L15,7.044C15.552,7.044 16,7.492 16,8.044C16,8.596 15.552,9.044 15,9.044L3.414,9.044L8.747,14.377C9.137,14.767 9.137,15.401 8.747,15.791C8.357,16.181 7.723,16.181 7.333,15.791L0.293,8.751C0.102,8.561 0,8.307 0,8.044C0,7.781 0.102,7.527 0.293,7.337Z"})})}function Br({title:e,subhead:t,children:n}){const{prev:r}=Kn(),{bg:a,text:s}=W();function c(o){return!Gn(o)||typeof o.type=="string"?o:o.type===x?Vi.map(o.props.children,c):rr(o,{className:`bg-white bg-opacity-90 ${s} ${o.props.className||""}`})}return i("div",{className:`px-3 ext-lg text-white ${a}`,children:[i("div",{className:"flex justify-end gap-x-2 gap-y-1 min-h-[36px] py-2",children:[!!r&&i(C,{back:!0,className:"-my-2 -ml-3",title:"Go Back",children:i(Mr,{})}),i("h1",{className:"flex-1 self-center py-1 text-xl font-semibold overflow-hidden whitespace-nowrap",children:e}),c(n)]}),t&&i("div",{className:`flex flex-col gap-y-1 pb-1 ${a} text-white text-sm font-semibold uppercase text-center`,children:t})]})}function M({title:e,buttons:t,subhead:n,footer:r,theme:a,children:s,contentRef:c}){const o=W();return a??(a=o),i(Xn,{value:a,children:i("div",{className:"fixed inset-0 flex flex-col",children:[i(Br,{title:e,subhead:n,children:t}),i("div",{ref:c,className:"relative flex-1 overflow-auto px-3 pb-3",children:s}),r&&i("div",{className:`relative ${a.bg} text-white font-semibold`,children:r})]})})}const tn=["bg1","disclaimer","accepted"],Ur={bg:"bg-red-600",text:"text-red-600"};function Fr(){const[e,t]=E(!!G.get(tn));return e?null:i(Hr,{onAccept:()=>{G.set(tn,1),t(!0)}})}function Hr({onAccept:e}){return i(M,{title:"Warning!",theme:Ur,children:[i("p",{children:'Use at your own risk. BG1 is highly experimental, for demonstration purposes only, and provided "as is" without warranty of any kind. It is in no way endorsed by or associated with the Walt Disney Company and could stop working at any time for any reason. To ensure the intended experience, always use the official Disney app.'}),i(V,{onClick:e,children:"Accept"})]})}function Zn(){return i(M,{title:"BG1 News",children:i("iframe",{src:"https://joelface.github.io/bg1/news.html",className:"absolute inset-0 w-full h-full"})})}const nn=["bg1","news","version"];function zr(e){const[t,n]=E(()=>{const r=Number(G.get(nn));return Number.isInteger(r)?r:0});return t<e?i(x,{children:[i(Zn,{}),i(V,{onClick:()=>{G.set(nn,e),n(e)},children:"Close"})]}):null}function xt(e){const t=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}}const jr="https://cdn.registerdisney.go.com/v4/OneID.js",Ke="oneid-script",Wr="oneid-wrapper",Vr="oneid-secure-responder";function Yr({resort:e,onLogin:t}){return S(()=>{const n=navigator.userAgent.includes("Android")?"AND":"IOS",r=`TPR-${e.id}-LBSDK.${n}`,a=()=>localStorage.removeItem(r+"-PROD.guest");let s=0;async function c(){if(!window.OneID){s=self.setTimeout(c,100);return}a();const o=window.OneID.get({clientId:r,responderPage:"https://bg1.joelface.com/responder.html"});o.on("login",({token:l})=>{a(),t({swid:l.swid,accessToken:l.access_token,expires:new Date(l.exp).getTime()})}),o.on("close",()=>{o.launchLogin()}),await o.init(),o.launchLogin()}if(!document.getElementById(Ke)){const o=document.createElement("script");o.id=Ke,o.src=jr,document.head.appendChild(o)}return c(),()=>{var o;s&&clearTimeout(s);for(const l of[Wr,Vr,Ke]){const d=document.getElementById(l);(o=d==null?void 0:d.parentNode)==null||o.removeChild(d)}}},[e,t]),i("div",{className:"fixed top-0 left-0 w-full h-full border-0"})}const ei=Q([]),ti=()=>J(ei);function qr({children:e}){const{das:t}=A(),[n,r]=E([]);return S(()=>{t.parties().then(r)},[t]),i(ei.Provider,{value:n,children:e})}/**
 * Refresh icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function wt({className:e}){return i(z,{className:e,children:i("path",{d:"M16 6h-6l2.243-2.243c-1.133-1.133-2.64-1.757-4.243-1.757s-3.109 0.624-4.243 1.757c-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.133 1.133 2.64 1.757 4.243 1.757s3.109-0.624 4.243-1.757c0.095-0.095 0.185-0.192 0.273-0.292l1.505 1.317c-1.466 1.674-3.62 2.732-6.020 2.732-4.418 0-8-3.582-8-8s3.582-8 8-8c2.209 0 4.209 0.896 5.656 2.344l2.343-2.344v6z"})})}function kt(e){const{children:t,color:n="bg-black",className:r="",...a}=e;return i("div",{className:`fixed inset-0 z-10 flex items-center justify-center p-2 ${n} bg-opacity-75 ${r}`,...a,children:t})}function Kr(){const{bg:e}=W();return i(kt,{color:"bg-white",children:i("div",{className:"w-[50px] mx-auto",children:i("div",{"aria-label":"Loading\u2026",className:`rounded-full p-[20%] ${e}`,children:i(wt,{className:"animate-spin w-full text-white"})})})})}const Qr=3e3,Jr={alert:"bg-yellow-200",error:"bg-red-200"};function ni(){const[,e]=E(0),[t,n]=E(""),[r,a]=E("alert"),s=K((o,l)=>{n(o),a(l||"alert"),e(d=>(clearTimeout(d),o?self.setTimeout(()=>{n("")},Qr):d))},[]);return[t?i(Xr,{message:t,type:r}):null,s]}function Xr({message:e,type:t}){return e?i("div",{role:"alert",className:`fixed bottom-20 left-0 w-full p-2 font-semibold text-center ${Jr[t]} text-gray-800`,children:e}):null}async function Zr(e){return new Promise(t=>{setTimeout(t,e)})}const es=500;function Y(){const[e,t]=E(0),[n,r]=ni(),a=K(async(c,o={})=>{var w;const{messages:l={},minLoadTime:d=es}=o,h={error:"Unknown error occurred",request:"Network request failed",...l};r("");let u=[""];function p(...I){u=I}t(I=>I+1);const f=Zr(d);try{await c(p)}catch(I){const v=(w=I==null?void 0:I.response)==null?void 0:w.status;I instanceof Error&&h[I.name]?p(h[I.name],"error"):Number.isInteger(v)?p(v in h?h[v]:h.request,"error"):(console.error(I),p(h.error,"error"))}await f,t(I=>I-1),r(...u)},[r]),s=e>0||n?i(x,{children:[e>0&&i(Kr,{}),n]}):null;return{loadData:a,loaderElem:s,flash:r}}function ii(e){const[,t]=E(0);return K((n=0)=>{t(r=>Date.now()-r<n?r:(e(),Date.now()))},[e])}const rn=["bg1","genie","park"],ri=Q({park:{},setPark:()=>{}}),Be=()=>J(ri);function ts({children:e}){const t=A(),[n,r]=E(()=>{const a=t.parks[0],{id:s=a.id,date:c=""}=G.get(rn)??{};try{return c===U()?t.park(s):a}catch(o){return o instanceof re||console.error(o),a}});return S(()=>{G.set(rn,{id:n.id,date:U()})},[n]),i(ri.Provider,{value:{park:n,setPark:r},children:e})}const si=Q({experiences:[],refreshExperiences:()=>{},park:{},setPark:()=>null,loaderElem:null}),fe=()=>J(si);function ns({children:e}){const{genie:t,liveData:n}=A(),{park:r,setPark:a}=Be(),{loadData:s,loaderElem:c}=Y(),[o,l]=E([]),d=ii(K(()=>{s(async()=>{const h=n.shows(r);let u={...Object.fromEntries((await t.experiences(r)).map(p=>[p.id,p]))};try{u={...await h,...u}}catch(p){console.error(p)}l(Object.values(u))})},[r,t,n,s]));return S(d,[d]),i(si.Provider,{value:{experiences:o,park:r,refreshExperiences:d,loaderElem:c,setPark:h=>{a(h),l([])}},children:e})}const ai=Q({plans:[],refreshPlans:()=>{},loaderElem:null}),le=()=>J(ai);function is({children:e}){const{genie:t}=A(),{loadData:n,loaderElem:r}=Y(),[a,s]=E([]),c=ii(K(()=>{n(async()=>{s(await t.bookings())})},[t,n]));return S(c,[c]),i(ai.Provider,{value:{plans:a,refreshPlans:c,loaderElem:r},children:e})}const oi=Q({current:void 0,begin:()=>{},end:()=>{}}),_e=()=>J(oi);function ci({children:e,current:t}){const[n,r]=E({current:t,begin:a=>{r({...n,current:a})},end:()=>{r(a=>a.current?{...a,current:void 0}:a)}});return i(oi.Provider,{value:n,children:e})}const li=Q({tabs:[],active:{name:"",icon:i("div",{}),component:()=>null},changeTab:()=>{},scrollPos:{get:()=>0,set:()=>{}}}),di=()=>J(li);function rs({name:e,icon:t}){const n=W(),{active:r,changeTab:a}=di();if(!a)return null;const c=(r==null?void 0:r.name)===e?`bg-white bg-opacity-90 ${n.text}`:`${n.bg} text-white`;return i("button",{className:"px-4 py-2",onClick:()=>a(e),children:[i("div",{className:`min-w-[3rem] rounded-full py-1.5 ${c}`,children:t}),i("div",{className:"mt-0.5 text-sm",children:e})]})}function It({title:e,buttons:t,subhead:n,children:r,contentRef:a}){const{tabs:s,scrollPos:c,footer:o}=di();let l=ie(null);return a&&(l=a),mt(()=>{const d=l.current;if(!d)return;d.scroll(0,c.get());const h=()=>c.set(d.scrollTop);return d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)},[c]),i(M,{title:e,buttons:t,subhead:n,footer:i(x,{children:[i("div",{className:"flex items-center justify-center",children:s.map(d=>be(rs,{...d,key:d.name}))}),o]}),contentRef:l,children:r})}function ss({tabs:e,footer:t},n){return function r({tabName:a}){const{goTo:s}=R(),c=K(d=>{d!==a&&s(i(r,{tabName:d}),{replace:!0})},[a,s]),o=ie(Object.fromEntries(e.map(d=>[d.name,0]))),l=e.find(({name:d})=>d===a)??e[0];return l?i(li.Provider,{value:{tabs:e,active:l,changeTab:c,scrollPos:{get:()=>o.current[l.name],set:d=>{o.current[l.name]=d}},footer:t},children:i(n,{tab:l})}):null}}/**
 * Calendar icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ui({className:e}){return i(z,{className:e,children:i("path",{d:"M5 6h2v2h-2zM8 6h2v2h-2zM11 6h2v2h-2zM2 12h2v2h-2zM5 12h2v2h-2zM8 12h2v2h-2zM5 9h2v2h-2zM8 9h2v2h-2zM11 9h2v2h-2zM2 9h2v2h-2zM13 0v1h-2v-1h-7v1h-2v-1h-2v16h15v-16h-2zM14 15h-13v-11h13v11z"})})}/**
 * Clock icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function as(e){return i(z,{...e,children:i("path",{d:"M10.293 11.707l-3.293-3.293v-4.414h2v3.586l2.707 2.707zM8 0c-4.418 0-8 3.582-8 8s3.582 8 8 8 8-3.582 8-8-3.582-8-8-8zM8 14c-3.314 0-6-2.686-6-6s2.686-6 6-6c3.314 0 6 2.686 6 6s-2.686 6-6 6z"})})}/**
 * Power icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function st(e){return i(z,{...e,children:i("path",{d:"M6 0l-6 8h6l-4 8 14-10h-8l6-6z"})})}/**
 * Checkmark icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function sn({className:e}){return i(z,{className:e,children:i("path",{d:"M13.5 2l-7.5 7.5-3.5-3.5-2.5 2.5 6 6 10-10z"})})}/**
 * Arrow-down icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function an(e){return i(z,{...e,children:i("path",{d:"M8 15.5l7.5-7.5h-4.5v-8h-6v8h-4.5z"})})}/**
 * Star icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function os(e){return i(z,{...e,children:i("path",{d:"M16 6.204l-5.528-0.803-2.472-5.009-2.472 5.009-5.528 0.803 4 3.899-0.944 5.505 4.944-2.599 4.944 2.599-0.944-5.505 4-3.899z"})})}function ee({date:e,time:t,type:n,...r}){return i("time",{...r,dateTime:e||t,children:e?lr(e,n):t?H(t):""})}function hi({start:e,end:t}){const n=U(e),r=U(t);return t?i(x,{children:[e.time?i(ee,{time:e.time}):i("span",{children:"Park Open"})," \u2013"," ",r>n?i(ee,{date:r,type:"short"}):t.time?i(ee,{time:t.time}):i("span",{children:"Park Close"})]}):i(ee,{time:e.time})}const on=i("span",{"aria-hidden":!0,children:"\u2022"});function mi({booking:e,button:t}){const n=W();return i("div",{className:"flex items-center gap-x-3",children:[i("div",{className:"flex-1 min-w-0",children:[i("div",{className:"flex items-center gap-x-2 text-gray-500 text-sm font-semibold uppercase whitespace-nowrap",children:[e.type==="DAS"&&i(x,{children:[i("span",{children:"DAS"}),on]}),e.type==="BG"?i(x,{children:[i("span",{children:["BG ",e.boardingGroup]}),e.status==="SUMMONED"&&i(x,{children:[on,i("span",{className:`${n.text} font-bold`,children:"Board Now"})]})]}):i(hi,{...e})]}),i("div",{className:"text-lg font-semibold leading-snug truncate",children:e.choices?"Multiple Experiences":e.name})]}),t&&i("div",{children:t})]})}function Ue(){const e=_e();return e.current?i("div",{children:i("div",{className:"-mx-3",children:[i("div",{className:"pb-1",children:"Modifying Reservation"}),i("div",{className:"px-3 py-2 bg-white text-black text-base font-normal normal-case text-left",children:i(mi,{booking:e.current,button:i(C,{type:"small",back:{screen:ce},onClick:e.end,children:"Keep"})})})]})}):null}function F({guests:e,selectable:t,conflicts:n}){const[r,a]=ni();if(e.length===0)return null;const s=new Set(t?e.filter(t==null?void 0:t.isSelected):[]),c=s.size>=((t==null?void 0:t.limit)??1/0);return i(x,{children:[i("ul",{className:"mt-2",children:e.map(o=>{var h;const l=s.has(o),d=c&&!l;return i("li",{className:"px-3 py-1",onClick:()=>a(d?"Selection limit reached":""),children:i("label",{className:"flex items-center",children:[t&&i("input",{type:"checkbox",checked:l,disabled:d,onChange:()=>t.onToggle(o),className:"mr-3"}),i("span",{className:"w-[48px] h-[48px] leading-[48px] mr-3 rounded-full text-3xl font-bold text-center bg-gray-400 text-white",children:o.avatarImageUrl?i("img",{src:o.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):i("span",{"aria-hidden":"true",children:o.name[0]})}),i("span",{className:"leading-tight",children:[o.name,(n==null?void 0:n[o.id])&&i("span",{className:"block text-xs font-semibold text-red-700 uppercase",children:(h=n[o.id])==null?void 0:h.replace(/_/g," ")})]})]})},o.id)})}),r]})}const pi=["bg1","genie","partyIds"];function fi(){const e=G.get(pi)??[];return Array.isArray(e)?e:[]}function cs(){const{genie:e}=A();S(()=>e.setPartyIds(fi()),[e])}function ls(){const{genie:e}=A(),{loadData:t,loaderElem:n}=Y(),[r,a]=E(!0),[s,c]=E(),[o,l]=E(()=>{const f=new Set(fi());return a(f.size===0),f});function d(){const f=[...o];G.set(pi,f),e.setPartyIds(f)}S(()=>{t(async()=>{const f=await e.guests();c([...f.eligible,...f.ineligible].sort((w,I)=>+!w.primary-+!I.primary||w.name.localeCompare(I.name)))})},[e,t]),S(()=>{r&&l(new Set)},[r]);const h=s==null?void 0:s.filter(f=>o.has(f.id)),u=s==null?void 0:s.filter(f=>!o.has(f.id)),p=f=>i("li",{children:i("label",{className:"flex items-center mt-2",children:[i("input",{type:"radio",name:"auto",onChange:()=>a(f.auto),checked:r===f.auto,className:"mr-2"})," ",f.children]})});return i(M,{title:"Party Selection",children:[i("p",{children:"By default, all eligible guests (up to a maximum of 12) are automatically selected when you book a Lightning Lane. If you would like to limit who you book for, you can manually select your party here."}),i("ul",{children:[i(p,{auto:!0,children:"Book for all eligible guests"}),i(p,{auto:!1,children:"Only book for selected guests"})]}),r?null:(s==null?void 0:s.length)===0?i("p",{className:"text-red-700",children:"No guests to select"}):h&&u?i(x,{children:[h.length>0&&i(x,{children:[i("h3",{children:"Your Party"}),i(F,{guests:h,selectable:{isSelected:()=>!0,onToggle:f=>{const w=new Set(o);w.delete(f.id),l(w)}}})]}),u.length>0&&i(x,{children:[i("h3",{children:"Add to Your Party"}),i(F,{guests:u,selectable:{isSelected:()=>!1,onToggle:f=>{const w=new Set(o);w.add(f.id),l(w)}}})]})]}):null,n,i(V,{back:!0,disabled:!r&&o.size===0,onClick:d,children:"Save"})]})}function Fe({name:e,onClick:t,...n}){return i(C,{...n,title:`Refresh ${e}`,onClick:t,children:i(wt,{})})}const _i=Q({eligible:[],ineligible:[],selected:[],setSelected:()=>null,experience:{name:"",park:{name:"",theme:{bg:"",text:""}}}}),gi=_i.Provider,yi=()=>J(_i),ds="https://bg1.joelface.com/ping";async function Et(e,t){const{date:n}=L(),r=["bg1","ping",e.id,t];if(G.get(r)===n)return;const{ok:s}=await fetch(ds,{method:"POST",body:new URLSearchParams({resort:e.id,service:t})});s&&G.set(r,n)}function us(e){return i(z,{...e,children:i("path",{d:"M 5.5253906 0.9296875 L 3.4042969 3.0507812 L 8.3535156 8 L 3.4042969 12.949219 L 5.5253906 15.070312 L 10.474609 10.121094 L 12.595703 8 L 10.474609 5.8789062 L 5.5253906 0.9296875 z"})})}function vi(e){return i("div",{className:`mt-4 border-2 rounded border-green-600 p-1 font-semibold text-center text-green-600 bg-green-100 ${e.className}`,children:e.children})}function hs({bg:e,experiences:t,heading:n}){return i("div",{className:`mt-4 rounded ${e}`,children:[i("h3",{className:"mt-0 p-1 text-white text-center",children:n}),i("ul",{className:"list-disc py-2 pl-8 bg-white bg-opacity-90",children:t.map(r=>i("li",{children:r.name},r.id))})]})}function ge({start:e,end:t,button:n}){return i("div",{className:"mt-4 text-lg",children:i("div",{className:"flex items-center gap-x-3",children:[i("div",{children:[t?"Arrive by":"Reservation at",":"," ",i("span",{className:"pl-1 font-semibold",children:i(hi,{start:e,end:t})})]}),n]})})}function ms({booking:e,onCancel:t,dasGuest:n}){const{genie:r,das:a}=A(),s=e.type==="DAS"?a:r,{refreshPlans:c}=le(),[o,l]=E(new Set),{loadData:d,loaderElem:h}=Y(),{name:u,park:p,guests:f}=e,w=o.size===0,I=o.size===f.length;async function v(){w||(await d(async()=>{await s.cancelBooking([...o]),c()}),t(f.filter(k=>!o.has(k))))}return i(M,{title:"Cancel Guests",theme:p.theme,children:[i("h2",{children:u}),i("div",{children:p.name}),i(ge,{...e}),i("div",{className:"ml-3",children:i("label",{className:"flex items-center py-4",children:[i("input",{type:"checkbox",checked:I,onChange:()=>l(new Set(I?[]:f))}),i("span",{className:"ml-3",children:"Select All"})]})}),!w&&i("div",{className:"mb-4",children:[i("h3",{children:"Cancel These Guests"}),i(F,{guests:f.filter(k=>o.has(k)),selectable:{isSelected:()=>!0,onToggle:k=>{if(n&&k!==n&&o.has(n))l(new Set);else{const m=new Set(o);m.delete(k),l(m)}}}})]}),!I&&i("div",{children:[i("h3",{children:"Select Guests to Cancel"}),i(F,{guests:f.filter(k=>!o.has(k)),selectable:{isSelected:()=>!1,onToggle:k=>{l(new Set(k===n?f:o).add(k))}}})]}),i(V,{back:!0,disabled:w,onClick:v,children:"Cancel "+(I?"Reservation":"Guests")}),h]})}function bi({offer:e,onOfferChange:t,includeOfferTime:n}){const{genie:r}=A(),{loadData:a,loaderElem:s}=Y(),[c,o]=E(()=>(a(async()=>{const l=await r.times(e);if(n){const d={startTime:e.start.time,endTime:e.end.time},h=Number(e.start.time.split(":")[0]),u=l[0].hour;if(h<u)l.unshift({hour:h,slots:[d]});else if(h===u){const{slots:p}=l[0];p.length<3?p.push(d):d.startTime<p[0].startTime&&(p[0]=d),p.sort((f,w)=>f.startTime<w.startTime?-1:f.startTime>w.startTime?1:0)}}o(l)}),null));return c?c.length===0?i("p",{children:"No other times available"}):i(x,{children:[i("h3",{children:"More Available Times"}),i("table",{className:"whitespace-nowrap",children:c.map(({hour:l,slots:d})=>i("tr",{children:[i("th",{className:"pt-3 pr-2 text-gray-500 text-sm font-semibold text-right uppercase",children:`${l>12?l-12:l} ${l<12?"AM":"PM"}`}),d.map(h=>i("td",{className:"pt-3 pr-3 text-center",children:i(C,{onClick:()=>{a(async()=>{const u=h.startTime===e.start.time?e:await r.changeOfferTime(e,h);t(u)})},children:H(h.startTime)})},h.startTime))]},l))}),s]}):s}function ps({offer:e}){var l;const{goTo:t,goBack:n}=R(),{genie:r}=A(),{loadData:a,loaderElem:s}=Y(),{refreshPlans:c}=le();function o(){a(async()=>{const d=await r.book(e);c(),await n({screen:ce}),t(i(pe,{booking:d,isNew:!0}))})}return i(M,{title:"Lightning Lane",subhead:i(ci,{current:e.modifying,children:i(Ue,{})}),theme:e.experience.park.theme,children:[i("h2",{children:(l=e.experience)==null?void 0:l.name}),i("div",{children:e.experience.park.name}),i(ge,{...e,button:i(C,{type:"small",onClick:n,children:"Change"})}),i("h3",{children:"Your Party"}),i(F,{guests:e.guests.eligible}),s,i(V,{onClick:o,children:"Modify Lightning Lane"})]})}function fs({booking:e}){const{goTo:t,goBack:n}=R(),{genie:r}=A(),{loadData:a,loaderElem:s}=Y(),[c,o]=E(()=>(a(async()=>{const l=await r.offer({...e,flex:{}},e.guests,e);o(l)}),null));return i(M,{title:"Select Return Time",subhead:i(ee,{date:U(e.start)}),theme:e.park.theme,children:[i("h2",{children:e.name}),i("div",{children:e.park.name}),i(ge,{...e,button:i(C,{type:"small",onClick:n,children:"Keep"})}),c?i(x,{children:i(bi,{offer:c,onOfferChange:l=>{o(l),t(i(ps,{offer:l}))},includeOfferTime:!0})}):null,s]})}function pe({booking:e,isNew:t}){var g;const{goTo:n,goBack:r}=R(),{setPark:a}=Be(),s=A(),c=ti(),{name:o,park:l,choices:d,type:h,subtype:u,start:p}=e,f=h==="DAS"&&u==="IN_PARK"?e.guests.find(b=>c.find(P=>P.primaryGuest.id===b.id)):void 0,w=_e(),[I,v]=E(e.cancellable&&(h!=="DAS"||f)?e.guests:void 0),k=new Map([[l,[]],...s.parks.map(b=>[b,[]])]);for(const b of d||[])(g=k.get(b.park))==null||g.push(b);const m=[...k].filter(([,b])=>b.length>0).map(([b])=>b),y=(d?m.length===1?m[0]:{}:l).theme??bt;return i(M,{title:"Your "+{LL:"Lightning Lane",DAS:"DAS Selection",BG:"Boarding Group",APR:"Park Pass",RES:"Reservation"}[h],theme:y,buttons:e.modifiable&&i(C,{onClick:()=>{w.begin(e),a(e.park),r({screen:ce,props:{tabName:"LL"}})},children:"Modify"}),subhead:i(ee,{date:U(p)}),children:[d?i("h2",{children:"Multiple Experiences"}):i(x,{children:[i("h2",{children:o}),l.name&&i("div",{children:l.name})]}),h==="BG"?i(x,{children:[e.status==="SUMMONED"&&i(vi,{children:"Your boarding group has been called"}),i("h3",{children:["Boarding Group:"," ",i("span",{className:"ml-1 font-semibold",children:e.boardingGroup})]}),i("p",{children:"Check the official Disney app for return time and other virtual queue information."})]}):i(ge,{...e,button:s.genie.allowsTimeSelect&&e.modifiable&&i(C,{type:"small",onClick:()=>n(i(fs,{booking:e})),children:"Change"})}),d&&i(x,{children:[i("p",{children:[o&&i(x,{children:[i("b",{children:o})," was temporarily unavailable during your return time."," "]}),"You may redeem this Lightning Lane at one of these replacement experiences:"]}),[...k].filter(([,b])=>b.length>0).map(([b,P])=>i(hs,{heading:b.name,experiences:P,bg:b.theme.bg},b.id))]}),i("div",{className:"flex mt-4",children:[i("h3",{className:"inline mt-0",children:"Your Party"}),e.cancellable&&I&&i(C,{type:"small",onClick:()=>{n(i(ms,{booking:{...e,guests:I},dasGuest:f,onCancel:b=>{b.length>0?v(b):r()}}))},className:"ml-3",children:"Cancel"})]}),i(F,{guests:I||e.guests,conflicts:Object.fromEntries(e.type==="LL"?e.guests.filter(b=>(b.redemptions??1)!==1).map(b=>[b.id,`Redemptions left: ${b.redemptions}`]):[])}),t&&i(V,{onClick:()=>r({screen:ce,props:{tabName:"Plans"}}),children:"Show Plans"})]})}function xi({...e}){const{plans:t,refreshPlans:n,loaderElem:r}=le();return i(It,{title:"Your Plans",buttons:i(Fe,{name:"Plans",onClick:n}),theme:bt,...e,children:[i(_s,{plans:t}),r]})}const _s=_t(function({plans:t}){var l,d;const{goTo:n}=R(),r=W();function a(h){n(i(pe,{booking:h}))}const s=new Map,c=new Map;for(const h of t){const u=U(h.start);s.has(u)||s.set(u,[]),h.type!=="APR"&&((l=s.get(u))==null||l.push(h)),c.has(u)||c.set(u,new Set),(h.type!=="LL"||h.subtype!=="MEP")&&h.park.icon&&((d=c.get(u))==null||d.add(h.park))}const o=i("p",{className:"font-semibold text-center uppercase text-gray-500",children:"No existing plans"});return i("ul",{children:t.length>0?[...s].map(([h,u])=>i("li",{children:[i("div",{className:"sticky top-0 -mx-3 pt-1 bg-white",children:i("div",{className:"flex items-center",children:[i("h2",{className:`flex-1 mt-0 rounded-r-full px-3 py-1 ${r.bg} text-white text-sm uppercase`,children:i(ee,{date:h})}),i("ul",{className:"px-3 pl-2 text-lg text-right",children:[...c.get(h)??[]].map(p=>i("li",{className:"inline ml-1 first:ml-0","aria-label":p.name,children:p.icon},p.id))})]})}),u.length>0?i("ul",{className:u.length===0?"mt-3":"",children:u.map(p=>i("li",{className:"py-2.5 first:border-0 border-t-4 border-gray-300",onClick:()=>a(p),children:i(mi,{booking:p,button:i("div",{className:r.text,title:"More Info",children:i(us,{})})})},p.bookingId))}):o]},h)):o})});function gs({...e}){const{goTo:t}=R();return i(x,{children:i(C,{...e,onClick:()=>t(i(xi,{})),title:"Plans",children:i(ui,{})})})}function Tt(){const{ineligible:e}=yi();return i(F,{guests:e,conflicts:Object.fromEntries(e.map(t=>[t.id,t.eligibleAfter?`TOO EARLY (${H(t.eligibleAfter)})`:t.ineligibleReason||"ELIGIBLE FOR NEW BOOKING"]))})}function ys(){const{genie:e}=A(),t=_e();return i(x,{children:[t.current?i(x,{children:[i("h3",{children:"Unable to Modify"}),i("p",{children:"Your current reservation cannot be modified to this experience due to the following conflicts:"})]}):i(x,{children:[e.nextBookTime&&e.nextBookTime.slice(0,5)>L().time.slice(0,5)&&i(vi,{children:["Eligible at ",i(ee,{time:e.nextBookTime})]}),i("h3",{children:"No Eligible Guests"}),i("p",{children:"No one in your party is currently eligible for this Lightning Lane."})]}),i(Tt,{})]})}function vs({onRefresh:e}){return i(x,{children:[i("h3",{children:"No Guests Found"}),i("p",{children:"Your party could not be loaded. This is probably just a temporary network error. Wait a few seconds and try again."}),i(V,{onClick:e,children:"Try Again"})]})}function bs(e){return i("div",{className:`mt-4 border-2 rounded border-red-600 p-1 font-semibold text-center text-red-600 bg-red-100 ${e.className}`,children:e.children})}function xs({party:e}){const{eligible:t,ineligible:n,selected:r,setSelected:a,experience:s}=e,[c,o]=E(new Set(r)),{maxPartySize:l}=A().genie;function d(h){c[c.has(h)?"delete":"add"](h),o(new Set(c))}return i(gi,{value:e,children:i(M,{title:"Modify Party",theme:s.park.theme,children:[i("h2",{children:s.name}),i("div",{children:s.park.name}),i("h3",{children:"Your Party"}),i(F,{guests:t,selectable:{isSelected:h=>c.has(h),onToggle:d,limit:l}}),n.length>0&&i(x,{children:[i("h3",{children:"Ineligible Guests"}),i(Tt,{})]}),i(V,{back:!0,disabled:c.size===0,onClick:()=>{a(t.filter(h=>c.has(h)))},children:"Confirm Party"})]})})}function wi(){const{goTo:e}=R(),t=yi(),{eligible:n,selected:r}=t,{maxPartySize:a}=A().genie;return i(x,{children:[n.length>a&&r.length===a&&i(bs,{children:"Party size restricted"}),r.length>0?i(x,{children:[i("div",{className:"mt-4",children:[i("h3",{className:"inline mt-0",children:"Your Party"}),i(C,{type:"small",onClick:()=>e(i(xs,{party:t})),className:"ml-3",children:"Modify"})]}),i(F,{guests:r})]}):i(x,{children:[i("h3",{children:"Ineligible Guests"}),i(Tt,{})]})]})}function ws(){return i(x,{children:[i("h3",{children:"No Reservations Available"}),i("p",{children:"There aren't enough reservation slots available for your entire party. If only part of your group wishes to go on this attraction, edit your party to check again. Otherwise, go back to the attraction list and select another attraction."}),i(wi,{})]})}function ks({offer:e,onOfferChange:t}){var r;const{goBack:n}=R();return i(M,{title:"Select Return Time",subhead:i(Ue,{}),theme:e.experience.park.theme,children:[i("h2",{children:(r=e.experience)==null?void 0:r.name}),i("div",{children:e.experience.park.name}),i(ge,{...e,button:i(C,{type:"small",onClick:n,children:"Keep"})}),i(bi,{offer:e,onOfferChange:a=>{t(a),n()}})]})}function Is({offer:e,onOfferChange:t}){const{goTo:n}=R(),{genie:r}=A();return i(x,{children:[i("div",{className:"flex items-center",children:i(ge,{...e,button:r.allowsTimeSelect&&i(C,{type:"small",onClick:()=>n(i(ks,{offer:e,onOfferChange:t})),children:"Change"})})}),e.changed&&i("div",{className:"text-sm",children:[i("strong",{children:"Note:"})," Return time has been changed"]}),i(wi,{})]})}function Es({experience:e}){const{goTo:t}=R(),n=A(),{genie:r}=n,{refreshExperiences:a}=fe(),{refreshPlans:s}=le(),c=_e(),[o,l]=E(),[d,h]=E(),{loadData:u,loaderElem:p}=Y();async function f(){!d||!o||u(async()=>{const m=await r.book(d,o.selected);c.end();const y=new Set(o.selected.map(g=>g.id)),_=m.guests.filter(g=>!y.has(g.id));_.length>0&&(await r.cancelBooking(_),m.guests=m.guests.filter(g=>y.has(g.id))),m&&t(i(pe,{booking:m,isNew:!0}),{replace:!0}),s(),a(),Et(n,"G")},{messages:{410:"Offer expired"}})}const w=K(()=>{u(async()=>{const m=c.current?{eligible:c.current.guests,ineligible:[]}:await r.guests(e);l({...m,selected:m.eligible.slice(0,r.maxPartySize),setSelected:y=>l(_=>{if(!_)return _;const g=new Set(_.selected);return h(b=>b===null||y.some(P=>!g.has(P))?void 0:b),{..._,selected:y}}),experience:e})})},[r,e,c,u]);S(()=>{o||w()},[o,w]);const I=K(m=>{!o||o.selected.length===0||u(async()=>{try{const y=await r.offer(e,o.selected,c.current),{ineligible:_}=y.guests;if(_.length>0){const g=new Set(_.map(P=>P.id)),b=P=>!g.has(P.id);l({...o,eligible:o.eligible.filter(b),ineligible:[..._,...o.ineligible],selected:o.selected.filter(b)})}y.active?(d&&(y.changed=!1),h(y)):h(g=>g??null)}catch(y){throw m||h(null),y}},{messages:{410:d?"No reservations available":""}})},[r,e,o,d,c,u]);S(()=>{d===void 0&&I()},[d,I]);const v=(o==null?void 0:o.eligible.length)===0,k=v&&(o==null?void 0:o.ineligible.length)===0;return i(M,{title:"Lightning Lane",theme:e.park.theme,buttons:i(x,{children:[i(gs,{}),i(Fe,{onClick:()=>{v?w():I()},name:v?"Party":"Offer"})]}),subhead:i(Ue,{}),children:[i("h2",{children:e.name}),i("div",{children:e.park.name}),o&&i(gi,{value:o,children:k?i(vs,{onRefresh:w}):v?i(ys,{}):!o||d===void 0?i("div",{}):d===null?i(ws,{}):i(x,{children:[i(Is,{offer:d,onOfferChange:h}),i(V,{onClick:f,children:`${c.current?"Modify":"Book"} Lightning Lane`})]})}),p]})}function He({label:e,children:t}){return i("div",{className:"flex items-center flex-1 whitespace-nowrap",children:[i("span",{className:"mr-2 text-xs font-semibold uppercase text-gray-500",children:e})," ",t]})}function Ts({experience:e}){const{goTo:t}=R(),{flex:n}=e;return i(He,{label:"LL",children:i("span",{children:i(C,{onClick:()=>t(i(Es,{experience:e})),children:n.nextAvailableTime?H(n.nextAvailableTime):"none"})})})}function ki({children:e}){return i("div",{className:"mt-8 flex justify-center",children:i("div",{children:[i("h2",{className:"mt-0 pl-1 text-gray-500 text-sm leading-tight uppercase",children:"Symbols"}),i("div",{className:"border-2 border-gray-500 rounded px-2 py-0.5 bg-gray-100",children:i("table",{children:i("tbody",{children:e})})})]})})}function me({sym:e,def:t,onInfo:n}){return i("tr",{children:[i("th",{className:"py-0.5 text-center font-bold",children:e}),i("td",{className:"pl-3 py-0.5",children:t}),n&&i("td",{className:"pl-3 py-0.5",children:i(C,{type:"small",onClick:n,children:"Info"})})]})}const Ns="_SELECT_RADIO_BUTTON_";function Ii(e){const{options:t,selected:n,title:r,onChange:a,disabled:s,...c}=e,{bg:o}=W(),[l,d]=E(!1),[h,u]=E(0),p=ie(null),f=ie(null);mt(()=>{var $;if(($=t.values().next().value)!=null&&$.icon)return;const _=p.current,g=_==null?void 0:_.firstChild;if(!g)return;const b=g.nodeValue;if(!b)return;let P=0;for(const j of t.values())g.nodeValue=j.text,P=Math.max(_.offsetWidth,P);g.nodeValue=b,u(P)},[t]);const w=()=>{var _;return(_=f.current)==null?void 0:_.querySelector("input:checked")};S(()=>{var b;if(!l)return;const _=w();(b=_==null?void 0:_.closest("li"))==null||b.scrollIntoView(),_==null||_.focus();const g=P=>{var $;($=f.current)!=null&&$.contains(P.target)||d(!1)};return addEventListener("focusin",g),()=>removeEventListener("focusin",g)},[l]);const I=()=>{const _=w();if(_){const g=_.value,b=t.get(g);b&&a(b.value??g)}d(!1)},v=n?t.get(n):r!==void 0?{text:r}:void 0;if(!v)return null;const{icon:k,text:m}=v;let y=!1;return i(x,{children:[i(C,{...c,title:k?`${r}: ${m}`:r,disabled:s||t.size===0,onClick:()=>d(!0),children:[k||i("span",{className:"flex-1 truncate",style:{minWidth:`${h}px`},ref:p,children:m}),i(z,{className:"w-2.5 ml-2 shrink-0",children:i("path",{d:"m6.8273 12.401-5.6333-7.7812a1.0212 1.0212 117.05 0 1 0.82716-1.62l11.958-2e-7a1.0212 1.0212 62.952 0 1 0.82714 1.62l-1.6438 2.2705a79984 79984 125.9 0 0-2.3456 3.2401l-1.6437 2.2706a1.4479 1.4479 180 0 1-2.3456 4.4e-5z"})})]}),l&&i(kt,{onChange:()=>{y||I(),y=!1},onClick:_=>{var g;y||(!((g=f.current)!=null&&g.contains(_.target))||n&&_.target.value===n)&&(d(!1),_.preventDefault())},onKeyDown:({key:_})=>{["Enter"," "].includes(_)?I():_.startsWith("Arrow")&&(y=!0)},"data-testid":"shade",children:i("div",{className:"flex flex-col min-w-[50%] max-h-[90%] rounded-lg bg-white text-black",children:[r&&i("h3",{className:`mt-0 rounded-t-lg px-5 py-1 ${o} text-white font-semibold text-center`,children:r}),i("ul",{className:"overflow-auto",ref:f,children:[...t].map(([_,g])=>i("li",{className:"border-t-2 first:border-0 border-gray-300",children:i("label",{className:"flex flex-row items-center gap-x-2.5 px-4 py-3",children:[i("input",{type:"radio",name:Ns,value:_,defaultChecked:_===n,className:"w-4 h-4 shrink-0"})," ",g.icon&&i("span",{"aria-hidden":"true",children:g.icon})," ",g.text]})},g.text))})]})})]})}function Ei(e){const{parks:t,genie:n}=A(),{park:r,setPark:a}=fe(),s=_e(),c=pt(()=>new Map(t.map(o=>[o.id,{value:o,icon:o.icon,text:o.name}])),[t]);return i(Ii,{...e,options:c,selected:r.id,onChange:a,disabled:!!s.current&&!n.allowsCrossParkModify,title:"Park","data-testid":"park-select"})}function Ss({experience:{type:e,standby:t,virtualQueue:n}}){return t.nextShowTime||e==="ENTERTAINMENT"&&!t.waitTime?i(Ps,{standby:t}):n?i(Ds,{virtualQueue:n}):i(Cs,{standby:t})}const Cs=({standby:e})=>i(He,{label:"Standby",children:e.available?i(Nt,{time:e.waitTime!==void 0?e.waitTime+" min":"now"}):i(Ni,{text:"down"})}),Ps=({standby:e})=>i(He,{label:i(x,{children:["Next ",i("span",{className:"hidden xs:inline",children:"Show"})]}),children:e.nextShowTime?i(Nt,{time:H(e.nextShowTime)}):i(Ni,{text:"none"})}),Ds=({virtualQueue:e})=>i(He,{label:i("abbr",{title:"Virtual Queue",children:"VQ"}),children:i(Nt,{time:e.nextAvailableTime?H(e.nextAvailableTime):"closed"})}),Ti="inline-block border-2 rounded px-1.5 py-0.5 font-semibold",Nt=({time:e})=>i("span",{className:`${Ti} border-gray-500 text-gray-500 bg-gray-100`,children:e}),Ni=({text:e})=>i("span",{className:`${Ti} border-red-600 text-red-600 bg-red-100`,children:e});function As({bookTime:e,dropTime:t}){const n=W();return!e&&!t?null:i("div",{className:`flex justify-center gap-x-10 ${n.bg}`,children:[i(cn,{label:"Book",time:e}),i(cn,{label:"Drop",time:t})]})}function cn({label:e,time:t}){if(!t)return null;t=t.slice(0,5);const n=L().time.slice(0,5);return i("div",{children:[e,":"," ",i("time",{dateTime:t,className:"whitespace-nowrap",children:t>n?H(t):"now"})]})}async function Ls(e={}){return new Promise((t,n)=>{navigator.geolocation.getCurrentPosition(r=>{t(r)},r=>{n(r)},e)})}const Rs={maximumAge:15e3,timeout:2e3};function $s(){const[e,t]=E(),n=K(async()=>{try{const{coords:r}=await Ls(Rs);t(a=>a&&r.latitude===a[0]&&r.longitude===a[1]?a:[r.latitude,r.longitude])}catch{t(void 0)}},[]);return[e,n]}const ln=["bg1","genie","sort"],Os=(e,t)=>(e.priority||1/0)-(t.priority||1/0),Qe=(e,t)=>(t.standby.waitTime||-1)-(e.standby.waitTime||-1),Gs=(e,t)=>{var n,r;return Re(((n=e==null?void 0:e.flex)==null?void 0:n.nextAvailableTime)||"00:00")-Re(((r=t==null?void 0:t.flex)==null?void 0:r.nextAvailableTime)||"00:00")},Ms=(e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()),dn=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)),Bs=(e,t,n)=>e.geo===t.geo?0:e.geo?t.geo?n?dn(e.geo,n)-dn(t.geo,n):0:-1:1,Us={priority:(e,t)=>Os(e,t)||Qe(e,t),standby:(e,t)=>Qe(e,t),soonest:(e,t)=>Gs(e,t)||Qe(e,t),nearby:(e,t,n)=>Bs(e,t,n),aToZ:()=>0},un=new Map([["priority",{text:"Priority"}],["nearby",{text:"Nearby"}],["standby",{text:"Standby"}],["soonest",{text:"Soonest"}],["aToZ",{text:"A to Z"}]]);function Fs(e,t){const{n,s:r,e:a,w:s}=e.geo,[c,o]=t;return c<n&&c>r&&o<a&&o>s}function Hs(){const{experiences:e,park:t}=fe(),[n,r]=$s(),[a,s]=E(()=>{const l=G.get(ln);return l&&un.has(l)?l:"priority"});S(()=>{a==="nearby"&&r()},[e,a,r]);const c=K((l,d)=>{var h,u;return Number((h=d==null?void 0:d.flex)==null?void 0:h.available)-Number((u=l==null?void 0:l.flex)==null?void 0:u.available)||Us[a==="nearby"&&!(n&&Fs(t,n))?"priority":a](l,d,n)||Ms(l,d)},[n,t,a]);return{sortType:a,sorter:c,SortSelect:l=>i(Ii,{...l,options:un,selected:a,onChange:d=>{s(d),G.set(ln,d)},title:"Sort By"})}}const zs=30,js=60,hn=["bg1","genie","tipBoard","starred"],at="Lightning Pick",ot="Upcoming Drop",ct="Booked",mn=e=>e.experienced&&!e.starred;function Ws({contentRef:e}){cs();const{genie:t}=A(),{experiences:n,refreshExperiences:r,park:a,loaderElem:s}=fe(),{sortType:c,sorter:o,SortSelect:l}=Hs(),d=ie(!0);S(()=>{var u;d.current||(u=e.current)==null||u.scroll(0,0)},[c,e]),S(()=>{d.current=!1},[]);const h=he(a.dropTimes)[0];return i(It,{title:i(x,{children:"Availability"}),buttons:i(x,{children:[i(l,{}),i(Ei,{}),i(Fe,{name:"Experiences",onClick:r})]}),subhead:i(x,{children:[i(Ue,{}),i(As,{bookTime:t.nextBookTime,dropTime:h})]}),contentRef:e,children:[i(Vs,{experiences:n,park:a,sorter:o}),s]})}const Vs=_t(function({experiences:t,park:n,sorter:r}){const{goTo:a}=R(),s=W(),[c,o]=E(()=>{const m=G.get(hn)??[];return new Set(Array.isArray(m)?m:[])}),l=he(n.dropTimes)[0],d=Re(L().time);function h({id:m}){o(y=>(y=new Set(y),y.has(m)?y.delete(m):y.add(m),G.set(hn,[...y]),y))}const u=()=>a(i(qs,{})),p=m=>a(i(Ks,{park:n,experience:m})),f=()=>a(i(Qs,{})),w=({experiences:m,type:y})=>i("ul",{"data-testid":y,children:m.map(_=>{const[g]=he(_.dropTimes??[]);return i("li",{className:"pb-3 first:border-0 border-t-4 border-gray-300",children:[i("div",{className:"flex items-center gap-x-2 mt-2",children:[i(Ys,{experience:_,toggleStar:h}),i("h3",{className:"flex-1 mt-0 text-lg font-semibold leading-tight truncate",children:_.name}),_.lp?i(Je,{name:at,icon:st,onClick:u}):g?i(Je,{name:ot,icon:an,onClick:()=>p(_),className:g!==l?"opacity-50":""}):null,_.flex.preexistingPlan&&i(Je,{name:ct,icon:sn,onClick:f})]}),i("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[i(Ss,{experience:_}),i(Ts,{experience:_})]})]},_.id+(_.starred?"*":""))})}),I=t.filter(m=>!!m.flex).map(m=>{var b;const y=m.standby.waitTime||0,_=(b=m==null?void 0:m.flex)==null?void 0:b.nextAvailableTime,g=Math.trunc(m.priority||4);return{...m,lp:!!_&&y>=zs&&g<3&&Re(_)-d<=Math.min(js,(4-g)/3*y),starred:c.has(m.id)}}).sort((m,y)=>+!m.starred-+!y.starred||+!m.lp-+!y.lp||r(m,y)),v=I.filter(m=>!mn(m)),k=I.filter(mn).sort((m,y)=>m.name.localeCompare(y.name));return i(x,{children:[i(w,{experiences:v,type:"unexperienced"}),k.length>0&&i(x,{children:[i("h2",{className:`-mx-3 px-3 py-1 text-sm uppercase text-center ${s.bg} text-white`,children:"Previously Experienced"}),i(w,{experiences:k,type:"experienced"})]}),(v.length>0||k.length>0)&&i(ki,{children:[i(me,{sym:i(st,{className:s.text}),def:at,onInfo:u}),n.dropTimes.length>0&&i(me,{sym:i(an,{className:s.text}),def:ot,onInfo:p}),i(me,{sym:i(sn,{className:s.text}),def:ct,onInfo:f})]})]})});function Je({name:e,icon:t,onClick:n,className:r}){const a=W();return i("button",{title:`${e} (more info)`,className:`-mx-2 px-2 ${a.text} ${r}`,onClick:n,children:i(t,{})})}function Ys({experience:e,toggleStar:t}){const n=W();return i("button",{title:`${e.starred?"Remove from":"Add to"} Favorites`,className:"-m-2 p-2",onClick:()=>t(e),children:i(os,{className:e.starred?n.text:"text-gray-300"})})}function qs(){return i(M,{title:at,children:i("p",{children:"When an attraction with a long standby wait has a Lightning Lane return time in the near future, it's highlighted as a Lightning Pick. Book these quick before they're gone!"})})}function Ks({park:e,experience:t}){const n=A(),r=he((t==null?void 0:t.dropTimes)??[])[0],a=n.parks.filter(s=>s.dropTimes.length>0).sort((s,c)=>s===e?-1:c===e?1:0);return i(M,{title:ot,children:[i("p",{children:[t?i("b",{children:t.name}):"This attraction"," may be part of"," ",r?i(x,{children:["the"," ",i("time",{dateTime:r,className:"font-semibold",children:H(r)})]}):i(x,{children:"an upcoming"})," ","drop of additional Lightning Lane inventory, with earlier return times than what's currently being offered. Availability varies but is always limited, so be sure you're ready to book when the drop time arrives!"]}),a.map(s=>{const[c]=he(s.dropTimes);return i("div",{className:`mt-5 rounded overflow-hidden ${s.theme.bg}`,children:[i("h2",{className:`mt-0 py-1 ${s.theme.bg} text-white text-base text-center`,children:s.name}),i("div",{className:"flex flex-col px-2 pb-3 bg-white bg-opacity-90",children:n.dropExperiences(s).map((o,l)=>{var u;const d=l===1&&s.name==="Hollywood Studios",h=new Set(he(o.dropTimes??[]));return i("div",{children:[i("h3",{className:`mt-3 text-base ${d?`${s.theme.text}font-bold`:""}`,children:o.name}),i("ul",{className:"flex flex-wrap gap-y-2 mt-1 leading-tight",children:(u=o.dropTimes)==null?void 0:u.map(p=>{const f=p===c;return i("li",{className:"min-w-[6em] text-center",children:[i("div",{className:`${f?`${s.theme.text} font-bold`:h.has(p)?"font-semibold":"text-gray-500"}`,children:i("time",{dateTime:p,children:H(p)})}),f?i("div",{className:`rounded-sm ${s.theme.bg} text-white text-opacity-90 text-xs font-semibold text-center uppercase`,children:"next"}):null]},p)})})]},o.id)})})]},s.id)})]})}function Qs(){return i(M,{title:ct,children:i("p",{children:"You currently have a Lightning Lane reservation for this attraction."})})}/**
 * Exit icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Js(e){return i(z,{...e,children:i("path",{d:"M12 10v-2h-5v-2h5v-2l3 3zM11 9v4h-5v3l-6-3v-13h11v5h-1v-4h-8l4 2v9h4v-3z"})})}/**
 * News icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Xs(e){return i(z,{...e,children:i("path",{d:"M14 4v-2h-14v11c0 0.552 0.448 1 1 1h13.5c0.828 0 1.5-0.672 1.5-1.5v-8.5h-2zM13 13h-12v-10h12v10zM2 5h10v1h-10zM8 7h4v1h-4zM8 9h4v1h-4zM8 11h3v1h-3zM2 7h5v5h-5z"})})}/**
 * Cog icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function Zs(e){return i(z,{...e,children:i("path",{d:"M14.59 9.535c-0.839-1.454-0.335-3.317 1.127-4.164l-1.572-2.723c-0.449 0.263-0.972 0.414-1.529 0.414-1.68 0-3.042-1.371-3.042-3.062h-3.145c0.004 0.522-0.126 1.051-0.406 1.535-0.839 1.454-2.706 1.948-4.17 1.106l-1.572 2.723c0.453 0.257 0.845 0.634 1.123 1.117 0.838 1.452 0.336 3.311-1.12 4.16l1.572 2.723c0.448-0.261 0.967-0.41 1.522-0.41 1.675 0 3.033 1.362 3.042 3.046h3.145c-0.001-0.517 0.129-1.040 0.406-1.519 0.838-1.452 2.7-1.947 4.163-1.11l1.572-2.723c-0.45-0.257-0.839-0.633-1.116-1.113zM8 11.24c-1.789 0-3.24-1.45-3.24-3.24s1.45-3.24 3.24-3.24c1.789 0 3.24 1.45 3.24 3.24s-1.45 3.24-3.24 3.24z"})})}/**
 * User icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function ea(e){return i(z,{...e,children:i("path",{d:"M9 11.041v-0.825c1.102-0.621 2-2.168 2-3.716 0-2.485 0-4.5-3-4.5s-3 2.015-3 4.5c0 1.548 0.898 3.095 2 3.716v0.825c-3.392 0.277-6 1.944-6 3.959h14c0-2.015-2.608-3.682-6-3.959z"})})}function ta(){const{goTo:e}=R(),[t]=E([{text:"Party Selection",icon:i(ea,{}),action:()=>e(i(ls,{}))},{text:"Log Out",icon:i(Js,{}),action:()=>q.deleteData()},{text:"BG1 News",icon:i(Xs,{}),action:()=>e(i(Zn,{}))}]),[n,r]=E(!1),a=ie(null);return i(x,{children:[i("button",{className:"absolute top-0 right-0 h-full px-4",onClick:()=>r(!0),title:"Settings Menu",children:i(Zs,{})}),n&&i(kt,{onClick:s=>{var c;(c=a.current)!=null&&c.contains(s.target)||r(!1)},"data-testid":"shade",children:i("ul",{className:"overflow-auto min-w-[50%] max-h-[90%] rounded-lg bg-white text-black text-lg font-normal",ref:a,children:t.map(s=>i("li",{className:"border-t-2 first:border-0 border-gray-300",children:i("button",{className:"flex flex-row items-center w-full px-4 py-3",onClick:()=>{r(!1),setTimeout(s.action,50)},children:[i("span",{className:"mr-2.5 text-gray-700","aria-hidden":!0,children:s.icon}),s.text]})},s.text))})})]})}function Si(e){const[t,n]=e.split(":").map(Number);return t*60+n}const na=(e,t)=>Si(e)-t;function pn({park:e,onSelect:t}){const{das:n}=A(),{loadData:r,loaderElem:a}=Y(),[s,c]=E();S(()=>{r(async()=>{const l=await n.experiences(e);c(l.filter(d=>d.available&&!!d.time).sort((d,h)=>d.name.localeCompare(h.name)))})},[e,n,r]);const o=[{heading:"Attractions",type:"ATTRACTION"},{heading:"Characters",type:"CHARACTER"},{heading:"Entertainment",type:"ENTERTAINMENT"}];return i(M,{title:"Select Experience",theme:e.theme,children:[s?s.length>0?i(x,{children:o.map(l=>i(ia,{park:e,experiences:s.filter(d=>d.type===l.type),heading:l.heading,onSelect:t},l.type))}):i("p",{children:"No DAS experiences available"}):null,a]})}function ia({park:e,experiences:t,heading:n,onSelect:r}){if(t.length===0)return null;const a=Si(L().time);return i("div",{className:`mt-4 rounded overflow-hidden ${e.theme.bg}`,children:[i("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:n}),i("ul",{className:"bg-white bg-opacity-90 leading-snug",children:t.map(s=>i("li",{className:"flex items-center pt-3 last:pb-3",children:[i("div",{className:"flex-1 px-2",children:s.name}),i("div",{className:"px-2",children:i(C,{onClick:()=>r(s),children:i("span",{className:"min-w-[4rem]",children:[na(s.time,a)," ",i("abbr",{title:"minutes",children:"min."})]})})})]},s.id))})]})}function fn({park:e,party:t}){const{goTo:n,goBack:r}=R(),a=A(),{das:s}=a,{refreshPlans:c}=le(),[o,l]=E(),[d,h]=E(new Set([t.primaryGuest,...t.linkedGuests].slice(0,t.selectionLimit))),[u,p]=E({}),{loadData:f,loaderElem:w}=Y();async function I(){o&&f(async()=>{try{const v=await s.book({park:e,experience:o,primaryGuest:t.primaryGuest,guests:[...d]});c(),Et(a,"D"),await r({screen:ce}),n(i(pe,{booking:v,isNew:!0}))}catch(v){throw v instanceof Hn&&p(v.conflicts),v}},{messages:{ConflictsError:"Some guests not eligible",ExperienceUnavailable:"Experience currently unavailable"}})}return i(M,{title:"DAS Selection",theme:e.theme,children:[i("h3",{children:"Experience"}),o?i("div",{className:"flex items-center mt-3",children:[i("div",{className:"text-lg font-semibold truncate",children:o.name}),i("div",{className:"ml-3",children:i(C,{type:"small",onClick:()=>n(i(pn,{park:e,onSelect:v=>{l(v),r()}})),children:"Change"})})]}):i("div",{className:"mt-3 text-center",children:i(C,{onClick:()=>n(i(pn,{park:e,onSelect:v=>{l(v),r()}})),children:"Select Experience"})}),i("h3",{children:"DAS Guest"}),i(F,{guests:[t.primaryGuest],conflicts:u}),t.linkedGuests.length>0&&i(x,{children:[i("h3",{children:"Additional Guests"}),i(F,{guests:t.linkedGuests,selectable:{isSelected:v=>d.has(v),onToggle:v=>{d[d.has(v)?"delete":"add"](v),h(new Set(d))},limit:t.selectionLimit-1},conflicts:u})]}),i(V,{disabled:!t||!o,onClick:I,children:"Request Return Time"}),w]})}function ra({parties:e}){const{goTo:t}=R(),{park:n}=Be(),{plans:r,refreshPlans:a,loaderElem:s}=le();mt(a,[a]);const c=new Set(e.map(u=>u.primaryGuest.id)),o=r.filter(u=>u.type==="DAS"&&u.subtype==="IN_PARK"),l=new Map(o.filter(u=>u.type==="DAS"&&u.subtype==="IN_PARK").map(u=>{var p;return[((p=u.guests.find(f=>c.has(f.id)))==null?void 0:p.id)??"",u]}));if(!s&&e.length===1){const u=e[0],p=l.get(u.primaryGuest.id);return p?i(pe,{booking:p}):i(fn,{park:n,party:u})}const d=e.filter(u=>!(l!=null&&l.has(u.primaryGuest.id))),h=e.filter(u=>l==null?void 0:l.has(u.primaryGuest.id));return i(M,{title:`DAS ${e.length===1?"Selection":"Parties"}`,theme:n.theme,children:s||(e.length>0?i(x,{children:[d.length>0&&i(x,{children:[i("h3",{children:"Select Next Experience"}),i("ul",{className:"mt-2",children:d.map(u=>i("li",{className:"flex items-center gap-x-3 pl-3 py-1",children:[i("span",{className:"flex-shrink-0 w-[48px] h-[48px] leading-[48px] rounded-full text-3xl font-bold text-center bg-gray-400 text-white","aria-hidden":"true",children:u.primaryGuest.avatarImageUrl?i("img",{src:u.primaryGuest.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):u.primaryGuest.name[0]}),i("span",{className:"flex-1 leading-tight",children:u.primaryGuest.name}),i(C,{type:"small",onClick:()=>t(i(fn,{park:n,party:u})),children:"Select"})]},u.primaryGuest.id))})]}),h.length>0&&i(x,{children:[i("h3",{children:"Current Selection"}),i("ul",{className:"mt-2",children:h.map(u=>{const p=l.get(u.primaryGuest.id);return i("li",{className:"flex items-center gap-x-3 pl-3 py-1",children:[i("span",{className:"flex-shrink-0 w-[48px] h-[48px] leading-[48px] rounded-full text-3xl font-bold text-center bg-gray-400 text-white","aria-hidden":"true",children:u.primaryGuest.avatarImageUrl?i("img",{src:u.primaryGuest.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):u.primaryGuest.name[0]}),i("div",{className:"flex-1",children:[i("div",{children:u.primaryGuest.name}),p&&i("div",{className:"text-gray-500 text-xs font-semibold uppercase",children:[p.name," @"," ",i(ee,{time:p.start.time})]})]}),i(C,{type:"small",onClick:()=>{p&&t(i(pe,{booking:p}))},children:"Details"})]},u.primaryGuest.id)})})]})]}):i("div",{}))})}function sa({contentRef:e}){const{goTo:t}=R(),{experiences:n,refreshExperiences:r,loaderElem:a}=fe(),s=ti();return i(It,{title:"Times Guide",buttons:i(x,{children:[s.length>0&&i(C,{title:"Disability Access Service",onClick:()=>t(i(ra,{parties:s})),children:"DAS"}),i(Ei,{}),i(Fe,{name:"Times",onClick:r})]}),contentRef:e,children:[i(aa,{experiences:n}),a]})}const aa=_t(function({experiences:t}){const{goTo:n}=R(),r=s=>n(i(oa,{exp:s})),a=new Map;return t.filter(s=>{var c;return s.standby.available||s.standby.unavailableReason==="TEMPORARILY_DOWN"||((c=s.individual)==null?void 0:c.available)||s.virtualQueue}).sort((s,c)=>s.land.sort-c.land.sort||s.name.localeCompare(c.name)).forEach(s=>{var c,o;a.has(s.land)||a.set(s.land,{ATTRACTION:[],ENTERTAINMENT:[],CHARACTER:[],HOLIDAY:[]}),(o=(c=a.get(s.land))==null?void 0:c[s.type])==null||o.push(s)}),i(x,{children:[[...a].map(([s,c])=>i("div",{children:[i("h2",{className:`pr-1 ${s.theme.text} text-sm font-semibold text-right uppercase`,children:s.name}),i("div",{className:"rounded overflow-hidden",children:[i(Ce,{title:"Attractions",land:s,experiences:c.ATTRACTION,onInfoClick:r}),i(Ce,{title:"Entertainment",land:s,experiences:c.ENTERTAINMENT,onInfoClick:r}),i(Ce,{title:"Holiday Entertainment",land:s,experiences:c.HOLIDAY,onInfoClick:r}),i(Ce,{title:"Characters",land:s,experiences:c.CHARACTER,onInfoClick:r})]})]},s.name)),t.length>0&&i(ki,{children:[i(me,{sym:"*",def:"No posted wait/show time"}),i(me,{sym:"\u274C",def:"Temporarily down"}),i(me,{sym:"VQ",def:"Virtual queue"})]})]})});function Ce({title:e,land:t,experiences:n,onInfoClick:r}){return n.length===0?null:i("div",{className:`${t.theme.bg}`,"data-testid":`${t.name}-${e}`,children:[i("h3",{className:"mt-0 py-1 text-white text-xs font-semibold text-center uppercase",children:e}),i("table",{className:"w-full leading-snug",children:i("tbody",{children:n.map(a=>{var s;return i("tr",{className:"group",children:[i("td",{className:`${a.standby.nextShowTime?"min-w-[5.625rem]":"min-w-[2.75rem]"} px-2 py-0.5 group-first:pt-1 group-last:pb-1 bg-white bg-opacity-80 font-bold text-center uppercase whitespace-nowrap`,children:a.standby.nextShowTime?(((s=a.additionalShowTimes)==null?void 0:s.length)??0)>0?i("button",{onClick:()=>r(a),className:"underline",children:H(a.standby.nextShowTime)}):H(a.standby.nextShowTime):a.standby.available?a.standby.waitTime??"*":a.virtualQueue&&a.standby.unavailableReason==="NOT_STANDBY_ENABLED"?"VQ":"\u274C"}),i("td",{className:"w-full px-1 pl-2 py-0.5 group-first:pt-1 group-last:pb-1 bg-white bg-opacity-90",children:i("div",{className:"flex items-center gap-x-2",children:[i("div",{className:`flex-1 ${a.type==="ATTRACTION"&&!a.virtualQueue&&(a.priority??4)<4?`font-bold ${t.theme.text}`:""}`,children:a.name}),(a==null?void 0:a.individual)&&i("div",{className:`${t.theme.text} text-xs leading-tight font-semibold text-center uppercase`,children:[i("div",{children:[i("abbr",{title:"Individual Lightning Lane",children:"ILL"}),": "+a.individual.displayPrice]}),a.individual.nextAvailableTime&&i("div",{children:H(a.individual.nextAvailableTime)})]})]})})]},a.id)})})})]})}const oa=({exp:e})=>{var t;return i(M,{title:"Experience Info",children:[i("h2",{children:e.name}),i("div",{children:e.park.name}),i("h3",{children:["Upcoming ",e.type==="CHARACTER"?"Appearances":"Shows"]}),i("ul",{className:"list-disc mt-2 pl-6",children:[!!e.standby.nextShowTime&&i("li",{children:H(e.standby.nextShowTime)}),(t=e.additionalShowTimes)==null?void 0:t.map(n=>i("li",{children:H(n)},n))]})]})},_n=6e4,Ci=["bg1","genie","merlock","tab"],ca=()=>G.get(Ci)??"LL",la=[{name:"LL",icon:i(st,{}),component:Ws},{name:"Times",icon:i(as,{}),component:sa},{name:"Plans",icon:i(ui,{}),component:xi}],da=i(ta,{}),ce=ss({tabs:la,footer:da},({tab:e})=>{const{current:t}=Kn(),n=_e(),{park:r}=Be(),{refreshExperiences:a}=fe(),{refreshPlans:s}=le(),c=ie(null);return S(()=>{G.set(Ci,e.name)},[e]),S(()=>xt(()=>{t.type===ce&&(a(_n),s(_n))}),[t,a,s]),S(()=>{var o;n.current&&((o=c.current)==null||o.scroll(0,0))},[n]),i(Xn,{value:r.theme,children:i(e.component,{contentRef:c})})});function ua(){return i(qr,{children:i(is,{children:i(ci,{children:i(ts,{children:i(ns,{children:i(Qn,{children:i(ce,{tabName:ca()})})})})})})})}const ha=500,gn=100,ma=5,pa=5*6e4;let Pi=0,Pe=0;const yn=()=>Date.now()+Pi;class fa extends Error{constructor(){super(...arguments);T(this,"name","SyncFailed")}}async function _a(){if(Date.now()-Pe<pa)return;const e=Pe;Pe=Date.now();let t=gn+1;try{const n=[];for(let r=0;r<ma;++r){try{const a=await ga();Number.isInteger(a)&&n.push(a)}catch(a){console.error(a);continue}if(!(n.length<2)){n.sort((a,s)=>a-s);for(const[a,s]of n.slice(0,-1).entries()){const c=n[a+1],o=Math.abs(s-c);o<t&&(t=o,Pi=Math.round((s+c)/2))}if(t<=gn)return}}throw new fa}catch(n){throw Pe=e,n}}async function ga(){const e=Date.now(),{headers:t}=await fetch("https://bg1.joelface.com/t"),n=Date.now();if(n-e>ha)return NaN;const a=parseFloat(String(t==null?void 0:t.get("T")))*1e3;return Math.round(a-(e+n)/2)}const ya=50;function va({onSync:e}){const[t,n]=E(yn());return S(()=>{const r=setInterval(()=>n(yn()),ya);return()=>clearInterval(r)},[]),S(()=>{_a().then(()=>e(!0)).catch(()=>e(!1))},[e]),i("time",{children:L(t).time})}function ba({time:e,label:t}){const[n,r]=E(!0);return i("table",{className:"mt-4 mx-auto text-gray-500",children:i("tbody",{children:[i(vn,{heading:t,time:i("time",{children:e||"--:--:--"})}),i(vn,{heading:"Current time",time:i(x,{children:[i(va,{onSync:r}),!n&&i("span",{className:"text-sm font-sans font-semibold text-red-600",children:[" ","(unsynced)"]})]})})]})})}function vn({heading:e,time:t}){return i("tr",{children:[i("th",{scope:"row",className:"pr-3 text-right text-xs font-semibold uppercase",children:[e,":"]}),i("td",{className:"text-xl font-mono leading-tight",children:["\uFEFF",t]})]})}function St({queue:e,title:t,children:n}){var r;return i(M,{title:t,theme:(r=e.park)==null?void 0:r.theme,children:[i("h2",{children:e.name}),n]})}const xa=5e3;function wa({queue:e,guests:t,result:n}){const{boardingGroup:r,conflicts:a}=n,s=r!==null,c=t.filter(u=>!(u.id in a)),o=t.filter(u=>u.id in a),{goBack:l}=R(),[d,h]=E(!1);return S(()=>{s&&setTimeout(()=>h(!0),xa)},[s]),i(St,{queue:e,title:"Boarding Group",children:s?i(x,{children:[i("h3",{children:"Congratulations! \u{1F389}"}),i("p",{children:"You joined the virtual queue!"}),i("p",{className:"text-lg font-semibold",children:["Boarding Group: ",r]}),i(F,{guests:c}),Object.keys(a).length>0&&i(x,{children:[i("p",{className:"font-semibold",children:"These guests could not join:"}),i(F,{guests:o,conflicts:a})]}),i("p",{children:"Refer to the My Disney Experience app for return time and other information."}),d&&i(V,{onClick:()=>l({screen:Di}),children:"Done"})]}):i(x,{children:[i("h3",{children:"Sorry!"}),i("p",{children:"A boarding group could not be obtained. Go back and try again."}),i(F,{guests:o,conflicts:a})]})})}function ka({queue:e,guests:t}){const{goTo:n}=R(),r=A(),{vq:a}=r,{loadData:s,loaderElem:c}=Y();async function o(){await s(async l=>{const d=await a.getQueue(e);if(!d.isAcceptingJoins)return l(d.isAcceptingPartyCreation?"Queue not open yet":"No boarding groups available");const h=await a.joinQueue(e,t);n(i(wa,{queue:e,guests:t,result:h}),{replace:!0}),h.boardingGroup!==null&&Et(r,"V")},{minLoadTime:999})}return i(St,{queue:e,title:"Virtual Queue",children:[!e.isAcceptingJoins&&i(ba,{time:e.nextScheduledOpenTime,label:"Next queue opening"}),!e.isAcceptingJoins&&e.nextScheduledOpenTime!==null&&i("p",{children:["Tap the ",i("b",{children:"Join Virtual Queue"})," button when the clock reads"," ",i("time",{className:"font-semibold",children:e.nextScheduledOpenTime}),". The queue can fill up almost instantly, so be quick!"]}),i("h3",{children:"Your Party"}),i(F,{guests:t}),i(V,{onClick:o,children:"Join Virtual Queue"}),c]})}function Ia({queue:e}){const{goTo:t}=R(),{vq:n}=A(),{loadData:r,loaderElem:a}=Y(),[s,c]=E([]),[o,l]=E(new Set);S(()=>{r(async()=>{const h=await n.getLinkedGuests(e);c(h),l(new Set(h.filter(u=>u.preselected)))})},[e,n,r]);function d(h){o[o.has(h)?"delete":"add"](h),l(new Set(o))}return i(St,{queue:e,title:"Choose Your Party",children:[e.howToEnterMessage.split(`

`).map((h,u)=>i("p",{children:h},u)),i("h3",{children:"Choose Your Party"}),s.length>0?i(F,{guests:s,selectable:{isSelected:h=>o.has(h),onToggle:d,limit:e.maxPartySize}}):i("p",{children:"No guests available"}),i(V,{disabled:o.size===0,onClick:()=>t(i(ka,{queue:e,guests:[...o]})),children:"Confirm Party"}),a]})}const bn=e=>e.categoryContentId==="attraction",De=e=>e.isAcceptingPartyCreation||e.isAcceptingJoins;function Di(){const{vq:e}=A(),{goTo:t}=R(),n=W(),{loadData:r,loaderElem:a}=Y(),[s,c]=E(),o=K(()=>{r(async()=>{c((await e.getQueues()).sort((l,d)=>+De(d)-+De(l)||+bn(d)-+bn(l)))})},[e,r]);return S(()=>(o(),xt(o)),[o]),i(M,{title:"Virtual Queues",buttons:i(C,{title:"Refresh Queues",onClick:o,children:i(wt,{})}),footer:i("div",{className:"p-2 text-right",children:i(C,{className:`bg-opacity-90 bg-white ${n.text}`,onClick:()=>q.deleteData(),children:"Log Out"})}),children:[s?s.length>0?i("ul",{className:"mt-1",children:s.map(l=>i("li",{className:"py-3 first:border-0 border-t-4 border-gray-300",children:[i("h2",{className:"mt-0",children:l.name}),i("div",{className:"flex items-center mt-2",children:[i("div",{className:"flex-1",children:l.isAcceptingJoins?i("span",{children:"Available now"}):l.nextScheduledOpenTime?i(x,{children:["Next opening:"," ",i("time",{dateTime:l.nextScheduledOpenTime,className:"font-semibold",children:H(l.nextScheduledOpenTime)})]}):"No more openings today"}),i("div",{className:"pl-3",children:i(C,{disabled:!De(l),onClick:()=>t(i(Ia,{queue:l})),children:De(l)?"Join Queue":"Closed"})})]})]},l.id))}):!a&&i("p",{className:"text-gray-500 font-semibold text-center uppercase",children:"No virtual queues found"}):null,a]})}function Ea(){return i(Qn,{children:i(Di,{})})}const Ta=0;function Na(){document.body.addEventListener("click",()=>null)}function Sa(){const[e,t]=E(),[n,r]=E(i("div",{})),a=Fr(),s=zr(Ta),[c,o]=E(()=>{try{q.getData()}catch(l){if(!(l instanceof Bn))throw l;return!0}return!1});return S(()=>{Na()},[]),S(()=>{q.onUnauthorized=()=>o(!0),(async()=>{for(const[l,d]of[[vt,ua],[yt,Ea]])try{const h=await Er(l.originToResortId(origin));t(h),cr({WDW:"America/New_York",DLR:"America/Los_Angeles"}[h.id]),r(i(Lr,{value:h,children:i(d,{})}));return}catch(h){if(!(h instanceof Fn))throw h}location.assign("https://joelface.github.io/bg1/start.html")})()},[]),S(()=>{function l(){if(!c)try{q.getData(),o(!1)}catch{o(!0)}}return l(),xt(l)},[c]),a||s||c&&e&&i(Yr,{resort:e,onLogin:l=>{q.setData(l),o(!1)}})||n}Ai();function Ai(){if(!document.body){setTimeout(Ai,100);return}document.close(),Ca(),Pa(),Da().render(i(Sa,{}))}function Ca(){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1, maximum-scale=1",document.head.appendChild(e)}function Pa(){const e=document.createElement("link");e.rel="icon",e.href="data:,",document.head.appendChild(e)}function Da(){return or(document.body.appendChild(document.createElement("div")))}
